using log4net;
using SOE.Core;
using SOE.Interfaces;
using SOE;
using Gateway.Player;
using Gateway.MapChat;
using System;
using System.Collections.Generic;
using Newtonsoft.Json;
using System.IO;
using System.Linq;
using static Gateway.Login.ClientPcData;
using System.Threading;
using Gateway.GameManager;


namespace Gateway.Login
{
    public static class LoginManager
    {
        public static ILog _log;
        public static SOEServer _server;

        public static List<ClientItemDefinition> ClientItemDefinitions;
        public static List<PointOfInterestDefinition> PointOfInterestDefinitions;
        public static List<string> WordBlacklist;



        public static List<PlayerCharacter> PlayerCharacters;

        public static void Start(SOEServer soeServer = null)
        {
            _server = soeServer ?? Gateway.Server;

            _log = _server.Logger.GetLogger("LoginManager");

            _log.Info("Service constructed");

            ClientItemDefinitions = new List<ClientItemDefinition>();
            PointOfInterestDefinitions = new List<PointOfInterestDefinition>();

            PlayerCharacters = new List<PlayerCharacter>();

            if (File.Exists(@"..\ofrserver\Customize\ClientItemDefinitions.json"))
                ClientItemDefinitions = JsonConvert.DeserializeObject<List<ClientItemDefinition>>(File.ReadAllText(@"..\ofrserver\Customize\ClientItemDefinitions.json"));

            if (File.Exists(@"..\ofrserver\Customize\PointOfInterestDefinitions.json"))
                PointOfInterestDefinitions = JsonConvert.DeserializeObject<List<PointOfInterestDefinition>>(File.ReadAllText(@"..\ofrserver\Customize\PointOfInterestDefinitions.json"));
            
            Thread characterReplicationThread = new Thread((characterReplicationThreadStart) =>
            {
                while (_server.Running)
                {
                    int now = (int)(DateTime.UtcNow - new DateTime(1970, 1, 1)).TotalSeconds;
                    List<SOEClient> Clients = _server.ConnectionManager.Clients;
                    for (int i = 0; i < Clients.Count; i++)
                    {
                        if (Clients[i] == null) continue;
                        SOEClient client = Clients[i];
                        foreach (PlayerCharacter character in PlayerCharacters)
                        {
                            if (client != character.client)
                            {
                                character.SendPlayerUpdatePacketUpdatePosition(client);
                                PetManager.SendUpdatePosition(client, character);
                            }
                        }
                    }

                    Thread.Sleep(1000);
                }
            });
            characterReplicationThread.Name = "LoginManager::CharacterReplicationThread";
            characterReplicationThread.Start();

            _server.ConnectionManager.OnDisconnect += HandleDisconnect;
        }

        private static void HandleDisconnect(SOEClient soeClient)
        {
            PlayerCharacter character = PlayerCharacters.Find(x => x.client == soeClient);
            if (character == null) return;
            character.Dispose();
            PlayerCharacters.Remove(character);
        }

        [SOEMessageHandler("PacketLogin", (ushort)ClientGatewayBasePackets.PacketLogin, "CGAPI_527")]
        public static void HandleLoginRequest(SOEClient soeClient, SOEMessage message)
        {
            SOEReader soeReader = new SOEReader(message);

            string ticket = soeReader.ReadASCIIString();
            ulong playerGUID = soeReader.ReadHostUInt64();
            string version = soeReader.ReadASCIIString();
            int unknown = soeReader.ReadHostInt32();

            _log.Debug($"Login Request from {soeClient.GetClientAddress()}:\n\t - Ticket: {ticket}\n\t - GUID: {playerGUID}\n\t - Version: {version}\n\t - Unknown: {unknown}");

            /*
            bool success = DatabaseManager.AttemptLogin(playerGUID, ticket);
            if (!success)
            {
                soeClient.Disconnect((ushort)SOEDisconnectReason.ConnectionRefused);
                return;
            }
            */

            PlayerCode.SendEncounterOverworldCombat(soeClient);
            soeClient.SendMessage(new SOEWriter(new SOEMessage((ushort)ClientGatewayBasePackets.PacketClientIsHosted, StringToByteArray("0700"))).GetFinalSOEMessage(soeClient));
            SendLoginReply(soeClient);
            SendInitializationParameters(soeClient);
            SendZoneDetails(soeClient);
            SendClientGameSettings(soeClient);
            SendAnnouncementData(soeClient);
            PlayerCode.SendPlayerUpdateItemDefinitions(soeClient);

            bool overrideName = true;
            string path = $@"..\ofrserver\Customize\PacketSendSelfToClient\Fallback.json";
            if (File.Exists($@"..\ofrserver\Customize\PacketSendSelfToClient\{ticket}.json"))
            {
                _log.Debug($"Found {ticket}.json!");
                overrideName = false;
                path = $@"..\ofrserver\Customize\PacketSendSelfToClient\{ticket}.json";
            }
            else
            {
                _log.Warn($"Was not able to find {ticket}.json!");
            }

            ClientPcDatas pcData = JsonConvert.DeserializeObject<ClientPcDatas>(File.ReadAllText(path), new JsonSerializerSettings()
            {
                TypeNameHandling = TypeNameHandling.Auto
            });
            pcData.PlayerGUID = soeClient.GetClientID() + 1;
            if (overrideName)
            {
                pcData.FirstName = ticket;
                pcData.LastName = "";
            }
            PlayerCode.SendSelfToClient(soeClient, pcData);
            PlayerCharacter character = new PlayerCharacter(soeClient, pcData);

            PlayerCharacters.Add(character);
        }

        public static void SendLoginReply(SOEClient soeClient)
        {
            var loginReply = new SOEWriter((ushort)ClientGatewayBasePackets.PacketLoginReply, true);

            loginReply.AddBoolean(true);

            SendTunneledClientPacket(soeClient, loginReply.GetRaw());
        }

        public static void SendInitializationParameters(SOEClient soeClient)
        {
            var initializationParameters = new SOEWriter((ushort)BasePackets.PacketInitializationParameters, true);

            initializationParameters.AddNullTerminatedString("live");

            SendTunneledClientPacket(soeClient, initializationParameters.GetRaw());
        }

        public static void SendZoneDetails(SOEClient soeClient)
        {
            var zoneDetails = new SOEWriter((ushort)BasePackets.PacketSendZoneDetails, true);

            zoneDetails.AddASCIIString("FabledRealms");
            zoneDetails.AddHostUInt32(2);
            zoneDetails.AddBoolean(false);
            zoneDetails.AddBoolean(false);
            zoneDetails.AddASCIIString("");
            zoneDetails.AddBoolean(false);
            zoneDetails.AddHostUInt32(0);
            zoneDetails.AddHostUInt32(5);
            zoneDetails.AddBoolean(false);
            zoneDetails.AddBoolean(false);

            SendTunneledClientPacket(soeClient, zoneDetails.GetRaw());
        }

        public static void SendClientGameSettings(SOEClient soeClient)
        {
            var clientGameSettings = new SOEWriter((ushort)BasePackets.PacketClientGameSettings, true);

            clientGameSettings.AddHostUInt32(4);
            clientGameSettings.AddHostUInt32(7);
            clientGameSettings.AddHostUInt32(268);
            clientGameSettings.AddBoolean(true);
            clientGameSettings.AddFloat(1.0f);

            SendTunneledClientPacket(soeClient, clientGameSettings.GetRaw());
        }

        public static void SendAnnouncementData(SOEClient soeClient)
        {
            var announcementData = new SOEWriter();

            const uint announcementCount = 1;

            announcementData.AddHostUInt32(announcementCount);

            for (var i = 0; i < announcementCount; i++)
            {
                announcementData.AddHostUInt32(139);
                announcementData.AddHostUInt32(1);
                announcementData.AddHostUInt32(47736);
                announcementData.AddHostUInt32(5103267);
                announcementData.AddHostUInt32(0);
                announcementData.AddHostUInt32(1911);
                announcementData.AddASCIIString("Exit");
                announcementData.AddASCIIString("Param");
                announcementData.AddHostUInt32(0);
                announcementData.AddHostUInt32(0);
                announcementData.AddHostUInt32(0);
                announcementData.AddASCIIString("");
            }

            var rawBytes = announcementData.GetRaw();

            var announcementBase = new SOEWriter((ushort)BasePackets.AnnouncementBasePacket, true);

            announcementBase.AddByte((byte)AnnouncementBasePackets.AnnouncementDataSendPacket);

            announcementBase.AddBytes(rawBytes);

            SendTunneledClientPacket(soeClient, announcementBase.GetRaw());
        }

        [SOEMessageHandler("PacketTunneledClientPacket", (ushort)ClientGatewayBasePackets.PacketTunneledClientPacket, "CGAPI_527")]
        public static void HandleTunneledClientPacket(SOEClient soeClient, SOEMessage soeMessage)
        {
            SOEReader reader = new SOEReader(soeMessage);

            var unknown = reader.ReadBoolean();
            var length = reader.ReadHostInt32();

            var opCode = reader.ReadHostUInt16();

            switch (opCode)
            {
                case (ushort)BasePackets.PacketClientIsReady:
                    HandlePacketClientIsReady(soeClient);
                    break;

                case (ushort)BasePackets.PlayerUpdatePacketUpdatePosition:
                    HandlePlayerUpdatePacketUpdatePosition(soeClient, reader);
                    break;

                case (ushort)BasePackets.BaseChatPacket:
                    HandleBaseChatPacket(soeClient, reader);
                    break;

                case (ushort)BasePackets.PetBasePacket:
                    PetManager.HandlePetBasePacket(soeClient, reader);
                    break;

                case (ushort)BasePackets.MountBasePacket:
                    MountManager.HandleMountBasePacket(soeClient, reader);
                    break;

                case (ushort)BasePackets.PacketZoneTeleportRequest:
                    HandlePacketZoneTeleportRequest(soeClient, reader);
                    break;

                case (ushort)BasePackets.PacketGameTimeSync:
                    HandlePacketGameTimeSync(soeClient, reader);
                    break;

                case (ushort)BasePackets.BaseQuickChatPacket:
                    HandleBaseQuickChatPacket(soeClient, reader);
                    break;

                case (ushort)BasePackets.BaseInventoryPacket:
                    HandleBaseInventoryPacket(soeClient, reader);
                    break;

                case (ushort)BasePackets.PacketZoneSafeTeleportRequest:
                    HandlePacketZoneSafeTeleportRequest(soeClient, reader);
                    break;

                case (ushort)BasePackets.PlayerUpdatePacketCameraUpdate:
                    break;

                default:
                    var data = reader.ReadToEnd();
                    //_log.Info($"HandleTunneledClientPacket OpCode: {opCode}\n{BitConverter.ToString(data).Replace("-", "")}");
                    break;
            }
        }

        private static void HandlePacketClientIsReady(SOEClient soeClient)
        {
            Chat.SendQuickChatPacket(soeClient);
            Map.SendPacketPointOfInterestDefinitionReply(soeClient);
            Map.SendPacketPOIChangeMessage(soeClient);
            NPCManager.SendPlayerUpdatePacketAddNpc(soeClient);
            NPCManager.SendWarpStones(soeClient);
            NPCManager.SendWarpWatchers(soeClient);
            UpdateStats.SendClientUpdatePacketHitpoints(soeClient);
            UpdateStats.SendClientUpdatePacketMana(soeClient);
            UpdateStats.SendAbilityPacketSetDefinition(soeClient);
            UpdateStats.SendClientUpdatePacketAddEffectTag(soeClient);
            UpdateStats.SendUpdatePacketUpdateStat(soeClient);
            SendPacketLoadWelcomeScreen(soeClient);
            //Map.SendObjectiveTargetUpdatePacket(soeClient);
            SendTunneledClientPacket(soeClient, StringToByteArray(/* CoinStoreItemListPacket */"A50001002A07000008000000080000000700000000000000000000090000000900000007000000000000000000000A0000000A00000007000000000000000000000B0000000B00000007000000000000000000000C0000000C00000007000000000000000000000D0000000D00000007000000000000000000000E0000000E00000007000000000000000000000F0000000F0000000700000000000000000000100000001000000007000000000000000000001100000011000000070000000000000000000012000000120000000700000000000000000000130000001300000007000000000000000000001400000014000000070000000000000000000015000000150000000700000000000000000000160000001600000007000000000000000000001700000017000000070000000000000000000018000000180000000700000000000000000000190000001900000007000000000000000000001A0000001A00000007000000000000000000001B0000001B00000007000000000000000000001C0000001C00000007000000000000000000001D0000001D000000070000000000000000000035000000350000001000000000000000000000360000003600000010000000000000000000003700000037000000100000000000000000000038000000380000001000000000000000000000390000003900000010000000000000000000006F0300006F03000010000000000000000000007003000070030000100000000000000000000071030000710300001000000000000000000000720300007203000010000000000000000000007303000073030000100000000000000000000084030000840300000700000000000000000000850300008503000007000000000000000000009003000090030000070000000000000000000091030000910300000700000000000000000000950A0000950A00003500000001000000000000F70A0000F70A0000C8000000000000000000002B0B00002B0B000010000000000000000000002C0B00002C0B000010000000000000000000002D0B00002D0B000010000000000000000000002E0B00002E0B000010000000000000000000004D0B00004D0B000010000000000000000000004F0B00004F0B00001000000000000000000000500B0000500B00001000000000000000000000510B0000510B00001000000000000000000000520B0000520B00001000000000000000000000530B0000530B00001000000000000000000000540B0000540B00001000000000000000000000560B0000560B00001000000000000000000000580B0000580B000010000000000000000000005A0B00005A0B00001000000000000000000000710B0000710B00003900000000000000000000790B0000790B00003500000001000000000000C00B0000C00B00003500000001000000000000C10B0000C10B00003900000001000000000000C30B0000C30B00000E00000000000000000000C50B0000C50B00000E00000000000000000000C70B0000C70B00000E00000000000000000000C90B0000C90B00003400000001000000000000CB0B0000CB0B00003600000001000000000000CD0B0000CD0B00000900000000000000000000CF0B0000CF0B00000900000000000000000000D10B0000D10B00000E00000000000000000000F00B0000F00B00003500000001000000000000020C0000020C00000E000000000000000000000C0C00000C0C00000900000000000000000000110C0000110C00000E00000000000000000000AA1A0000AA1A00008D00000000000000000000AB1A0000AB1A00008D00000000000000000000AC1A0000AC1A00008D00000000000000000000AD1A0000AD1A00008D00000000000000000000AE1A0000AE1A00008D00000000000000000000AF1A0000AF1A00008D00000000000000000000B01A0000B01A00008D00000000000000000000B11A0000B11A00008D00000000000000000000B21A0000B21A00008D00000000000000000000B31A0000B31A00008D00000000000000000000B41A0000B41A00008D00000000000000000000B51A0000B51A00008D00000000000000000000B61A0000B61A00008D00000000000000000000B71A0000B71A00008D00000000000000000000B81A0000B81A00008D00000000000000000000B91A0000B91A00008D00000000000000000000BA1A0000BA1A00008D00000000000000000000BB1A0000BB1A00008D00000000000000000000BC1A0000BC1A00008D00000000000000000000BD1A0000BD1A00008D00000000000000000000BE1A0000BE1A00008D00000000000000000000BF1A0000BF1A00008D00000000000000000000C01A0000C01A00008D00000000000000000000C11A0000C11A00008D00000000000000000000C21A0000C21A00008D00000000000000000000C31A0000C31A00008D00000000000000000000C41A0000C41A00008D00000000000000000000C51A0000C51A00008D00000000000000000000CD1E0000CD1E0000C800000000000000000000CF1E0000CF1E0000C800000000000000000000D21E0000D21E0000C800000000000000000000542300005423000034000000010000000000005523000055230000390000000100000000000065280000652800009300000001000000000000A7280000A7280000C800000000000000000000A8280000A8280000C80000000000000000000023290000232900000700000000000000000000242900002429000007000000000000000000003729000037290000070000000000000000000038290000382900000700000000000000000000392900003929000007000000000000000000003A2900003A2900000700000000000000000000AB2C0000AB2C000000000000000000000000005E2D00005E2D0000C800000000000000000000AF330000AF3300001000000000000000000000B5370000B53700002E01000000000000000000DB370000DB3700003900000000000000000000DC370000DC3700003900000000000000000000E1370000E13700003900000000000000000000E2370000E23700003900000000000000000000E3370000E33700003900000000000000000000E4370000E437000039000000000000000000005B3E00005B3E000033010000010000000000005C3E00005C3E000033010000010000000000005D3E00005D3E000033010000010000000000005E3E00005E3E000033010000010000000000005F3E00005F3E00003301000000000000000000A73E0000A73E00003900000000000000000000A83E0000A83E00003900000000000000000000A93E0000A93E00003900000000000000000000AA3E0000AA3E00003900000000000000000000AB3E0000AB3E00003900000000000000000000AC3E0000AC3E00003900000000000000000000BA410000BA4100003500000001000000000000BB410000BB4100003900000001000000000000C8410000C84100003900000001000000000000C9410000C94100003900000001000000000000CA410000CA4100003900000001000000000000F3410000F341000039000000010000000000009244000092440000C800000000000000000000B3460000B34600003900000000000000000000BE460000BE4600003500000001000000000000DA460000DA4600003900000001000000000000DB460000DB4600003900000001000000000000DF460000DF4600003900000001000000000000FB460000FB46000039000000010000000000008E5600008E5600000C0000000000000000000190560000905600000C00000000000000000001915600009156000069000000000000000000019356000093560000680000000000000000000194560000945600000C0000000000000000000196560000965600000C00000000000000000001985600009856000003000000000000000000019A5600009A56000066000000000000000000019C5600009C56000003000000000000000000019E5600009E56000065000000000000000000019F5600009F5600000300000000000000000001A1560000A15600006700000000000000000001A2560000A25600006A00000000000000000001A5560000A55600000300000000000000000001A6560000A65600006500000000000000000001845900008459000039000000010000000000002C6D00002C6D000033000000000000000000002D6D00002D6D000033000000000000000000002E6D00002E6D00003300000001000000000000316D0000316D00003300000001000000000000346D0000346D00003300000000000000000000356D0000356D00003300000000000000000000376D0000376D00003300000001000000000000386D0000386D00003300000001000000000000396D0000396D000033000000010000000000003A6D00003A6D000033000000010000000000003C6D00003C6D000033000000010000000000003D6D00003D6D000033000000010000000000003E6D00003E6D000033000000010000000000003F6D00003F6D00003B00000001000000000000406D0000406D00003B00000001000000000000446D0000446D00003B00000001000000000000456D0000456D00003B00000001000000000000466D0000466D00003B00000001000000000000476D0000476D00003B00000001000000000000486D0000486D00003B00000001000000000000496D0000496D00003B000000010000000000004A6D00004A6D00003B000000010000000000004B6D00004B6D00003B00000001000000000000516D0000516D00003B00000001000000000000526D0000526D00003B00000001000000000000536D0000536D00003B00000001000000000000546D0000546D00003B00000001000000000000566D0000566D00003B00000001000000000000586D0000586D00003B00000001000000000000596D0000596D00003B000000010000000000005B6D00005B6D00003B000000000000000000005C6D00005C6D00003B00000000000000000000FF790000FF7900000A00000000000000000000007A0000007A00000A00000000000000000000087A0000087A00000A000000000000000000000C7A00000C7A00000A00000000000000000000877F0000877F00009300000005000000000000887F0000887F00009300000005000000000000897F0000897F000093000000050000000000008A7F00008A7F000093000000050000000000008B7F00008B7F000093000000050000000000008C7F00008C7F000093000000050000000000008D7F00008D7F000093000000050000000000008E7F00008E7F000093000000050000000000008F7F00008F7F00009300000005000000000000907F0000907F00009300000005000000000000917F0000917F00009300000005000000000000927F0000927F00009300000005000000000000937F0000937F00009300000005000000000000947F0000947F00009300000005000000000000957F0000957F00009300000005000000000000967F0000967F00009300000005000000000000977F0000977F00009300000005000000000000987F0000987F00009300000005000000000000997F0000997F000093000000050000000000009A7F00009A7F000093000000050000000000009B7F00009B7F000093000000050000000000009C7F00009C7F000093000000050000000000009D7F00009D7F000093000000050000000000009E7F00009E7F000093000000050000000000009F7F00009F7F00009300000005000000000000A07F0000A07F00009300000005000000000000A17F0000A17F00009300000005000000000000A27F0000A27F00009300000005000000000000A37F0000A37F00009300000005000000000000A47F0000A47F00009300000005000000000000A57F0000A57F00009300000005000000000000A67F0000A67F00009300000005000000000000A77F0000A77F00009300000005000000000000A87F0000A87F00009300000005000000000000A97F0000A97F00009300000005000000000000AA7F0000AA7F00009300000005000000000000AB7F0000AB7F00009300000005000000000000AC7F0000AC7F00009300000005000000000000AD7F0000AD7F00009300000005000000000000AE7F0000AE7F00009300000005000000000000AF7F0000AF7F00009300000005000000000000B07F0000B07F00009300000005000000000000B17F0000B17F00009300000005000000000000B27F0000B27F00009300000005000000000000048D0000048D00003500000001000000000000058D0000058D00003500000001000000000000078D0000078D00003500000000000000000000088D0000088D00003500000001000000000000098D0000098D000035000000010000000000000A8D00000A8D000035000000010000000000000B8D00000B8D000035000000010000000000000E8D00000E8D000035000000010000000000000F8D00000F8D00003400000001000000000000118D0000118D00003600000001000000000000138D0000138D00003500000001000000000000148D0000148D00003500000001000000000000158D0000158D00003500000001000000000000168D0000168D00003500000001000000000000188D0000188D00003500000001000000000000198D0000198D000035000000010000000000001B8D00001B8D000034000000010000000000001C8D00001C8D000034000000010000000000001D8D00001D8D000034000000010000000000001E8D00001E8D000034000000010000000000001F8D00001F8D00003400000001000000000000208D0000208D00003400000001000000000000218D0000218D00003500000000000000000000228D0000228D00003400000001000000000000258D0000258D00003500000001000000000000268D0000268D00003500000001000000000000278D0000278D00003500000001000000000000298D0000298D000035000000010000000000002A8D00002A8D000035000000010000000000002B8D00002B8D000036000000010000000000002C8D00002C8D000035000000010000000000002D8D00002D8D000035000000010000000000002E8D00002E8D000036000000010000000000002F8D00002F8D00003600000001000000000000308D0000308D00003900000001000000000000338D0000338D000039000000000000000000003C8D00003C8D000035000000010000000000003D8D00003D8D000035000000010000000000003E8D00003E8D000035000000010000000000003F8D00003F8D00003500000001000000000000418D0000418D00003500000001000000000000428D0000428D00003600000001000000000000438D0000438D00003400000001000000000000448D0000448D00003500000001000000000000458D0000458D00003500000001000000000000468D0000468D00003500000001000000000000478D0000478D00003500000001000000000000488D0000488D00003400000001000000000000498D0000498D000034000000010000000000004B8D00004B8D000036000000010000000000004C8D00004C8D000036000000000000000000004D8D00004D8D000036000000000000000000004E8D00004E8D00003600000000000000000000518D0000518D00003500000001000000000000528D0000528D00003600000001000000000000538D0000538D00003600000001000000000000548D0000548D00003600000001000000000000558D0000558D00003600000001000000000000568D0000568D00003600000001000000000000578D0000578D00003600000001000000000000588D0000588D00003600000001000000000000598D0000598D000036000000010000000000005A8D00005A8D000035000000010000000000005B8D00005B8D000035000000010000000000005C8D00005C8D000035000000010000000000005D8D00005D8D00003500000001000000000000618D0000618D00003500000001000000000000628D0000628D00003500000001000000000000638D0000638D00003500000001000000000000658D0000658D00003600000001000000000000668D0000668D00003500000001000000000000678D0000678D00003500000001000000000000698D0000698D000035000000010000000000006A8D00006A8D000035000000010000000000006B8D00006B8D000035000000010000000000006C8D00006C8D000035000000010000000000006D8D00006D8D00003400000001000000000000608E0000608E00003500000001000000000000818E0000818E00003500000001000000000000848E0000848E00003500000001000000000000898E0000898E00003500000001000000000000948E0000948E00003500000001000000000000958E0000958E000035000000010000000000009B8E00009B8E000035000000010000000000009F8E00009F8E00003500000001000000000000A38E0000A38E00003500000001000000000000A48E0000A48E00003500000001000000000000AC8E0000AC8E00003500000001000000000000AD8E0000AD8E00003500000001000000000000B88E0000B88E00003500000001000000000000C08E0000C08E00003500000001000000000000C38E0000C38E00003500000001000000000000C78E0000C78E00003500000001000000000000C98E0000C98E00003500000001000000000000D18E0000D18E00003400000001000000000000D38E0000D38E00003500000001000000000000DC8E0000DC8E00003600000001000000000000DE8E0000DE8E00003500000001000000000000E68E0000E68E00003500000001000000000000E88E0000E88E00003500000001000000000000E98E0000E98E00003500000001000000000000EA8E0000EA8E00003500000001000000000000EC8E0000EC8E00003500000001000000000000EE8E0000EE8E00003500000001000000000000EF8E0000EF8E00003500000001000000000000F18E0000F18E00003500000001000000000000F58E0000F58E00003500000001000000000000F78E0000F78E00003500000001000000000000F88E0000F88E00003500000001000000000000FC8E0000FC8E00003500000001000000000000FD8E0000FD8E000035000000010000000000009390000093900000070000000000000000000094900000949000000700000000000000000000959000009590000007000000000000000000009690000096900000070000000000000000000098900000989000000700000000000000000000C5900000C59000000700000000000000000000C6900000C690000007000000000000000000003B9700003B9700002E010000000000000000003C9700003C9700002E010000000000000000003D9700003D9700002E010000000000000000003E9700003E9700002E010000000000000000003F9700003F9700002E0100000000000000000040970000409700002E0100000000000000000042970000429700002E0100000000000000000044970000449700002E0100000000000000000046970000469700002E0100000000000000000048970000489700002E010000000000000000004A9700004A9700002E010000000000000000004C9700004C9700002E010000000000000000008497000084970000C800000001000000000000C9DD0000C9DD00000700000000000000000000CADD0000CADD00000700000000000000000000D9E80000D9E800008100000000000000000000DFE80000DFE800008100000000000000000000E5E80000E5E800008200000000000000000000EBE80000EBE800008200000000000000000000F7E80000F7E800008500000000000000000000F9E80000F9E80000850000000000000000000004E9000004E9000085000000000000000000000AE900000AE90000860000000000000000000010E9000010E90000860000000000000000000040090100400901007900000000000000000000410901004109010079000000000000000000004209010042090100790000000000000000000043090100430901006C0000000000000000000044090100440901006C0000000000000000000045090100450901006C0000000000000000000046090100460901006C0000000000000000000047090100470901006C0000000000000000000048090100480901006C000000000000000000004C0901004C09010079000000000000000000004D0901004D09010079000000000000000000004E0901004E09010079000000000000000000004F0901004F0901006C0000000000000000000050090100500901006C0000000000000000000051090100510901006C0000000000000000000052090100520901006C0000000000000000000053090100530901006C0000000000000000000054090100540901006C00000000000000000000380A0100380A01003F00000000000000000000390A0100390A01003F000000000000000000003A0A01003A0A01003F000000000000000000003B0A01003B0A01003F000000000000000000003C0A01003C0A01003F000000000000000000003D0A01003D0A01003F000000000000000000003E0A01003E0A01003F000000000000000000003F0A01003F0A01003F00000000000000000000400A0100400A01003F00000000000000000000410A0100410A01003F00000000000000000000420A0100420A01003F00000000000000000000430A0100430A01003F00000000000000000000440A0100440A01003F00000000000000000000D10C0100D10C01008E00000000000000000000D20C0100D20C01008E00000000000000000000D30C0100D30C01008E00000000000000000000D40C0100D40C01008E00000000000000000000D50C0100D50C01008E00000000000000000000D60C0100D60C01008E00000000000000000000D70C0100D70C01008E00000000000000000000D80C0100D80C01008E00000000000000000000D90C0100D90C01008E00000000000000000000DA0C0100DA0C01008E00000000000000000000DB0C0100DB0C01008E00000000000000000000DC0C0100DC0C01008E00000000000000000000DD0C0100DD0C01008E00000000000000000000DE0C0100DE0C01008E00000000000000000000DF0C0100DF0C01008E00000000000000000000E00C0100E00C01008E00000000000000000000E10C0100E10C01008E00000000000000000000E20C0100E20C01008E00000000000000000000E30C0100E30C01008E00000000000000000000E40C0100E40C01008E00000000000000000000E50C0100E50C01008E00000000000000000000E60C0100E60C01008E00000000000000000000E70C0100E70C01008E00000000000000000000E80C0100E80C01008E00000000000000000000E90C0100E90C01008E00000000000000000000EA0C0100EA0C01008E00000000000000000000EB0C0100EB0C01008E00000000000000000000EC0C0100EC0C01008E00000000000000000000ED0C0100ED0C01008E00000000000000000000EE0C0100EE0C01008E00000000000000000000EF0C0100EF0C01008E00000000000000000000F00C0100F00C01008E00000000000000000000F20C0100F20C01008F00000000000000000000F30C0100F30C01008F00000000000000000000F40C0100F40C01008F00000000000000000000F50C0100F50C01008F00000000000000000000F60C0100F60C01008F00000000000000000000F70C0100F70C01008F00000000000000000000F80C0100F80C01008F00000000000000000000F90C0100F90C01008F00000000000000000000FA0C0100FA0C01008F00000000000000000000FB0C0100FB0C01008F00000000000000000000FC0C0100FC0C01008F00000000000000000000FD0C0100FD0C01008F00000000000000000000FE0C0100FE0C01008F00000000000000000000FF0C0100FF0C01008F00000000000000000000000D0100000D01008F00000000000000000000010D0100010D01008F00000000000000000000020D0100020D01008F00000000000000000000030D0100030D01008F00000000000000000000040D0100040D01008F00000000000000000000050D0100050D01008F00000000000000000000060D0100060D01008F00000000000000000000300D0100300D01009100000000000000000000310D0100310D01009100000000000000000000320D0100320D01009100000000000000000000330D0100330D01009100000000000000000000340D0100340D01009100000000000000000000350D0100350D01009100000000000000000000360D0100360D01009100000000000000000000370D0100370D01009100000000000000000000380D0100380D01009100000000000000000000390D0100390D010091000000000000000000003A0D01003A0D010091000000000000000000003B0D01003B0D010091000000000000000000003C0D01003C0D010091000000000000000000003D0D01003D0D010091000000000000000000003E0D01003E0D010091000000000000000000003F0D01003F0D01009100000000000000000000400D0100400D01009100000000000000000000410D0100410D01009100000000000000000000420D0100420D01009100000000000000000000490D0100490D010090000000000000000000004A0D01004A0D010090000000000000000000004B0D01004B0D010090000000000000000000004C0D01004C0D010090000000000000000000004D0D01004D0D010090000000000000000000004E0D01004E0D010090000000000000000000004F0D01004F0D01009000000000000000000000710D0100710D01009200000000000000000000720D0100720D01009200000000000000000000730D0100730D01009200000000000000000000740D0100740D01009200000000000000000000750D0100750D01009200000000000000000000760D0100760D01009200000000000000000000770D0100770D01009200000000000000000000780D0100780D01009200000000000000000000790D0100790D010092000000000000000000007A0D01007A0D010092000000000000000000007B0D01007B0D010092000000000000000000007C0D01007C0D010092000000000000000000001D1301001D1301003900000000000000000000F8240100F8240100CF00000001000000000000F9240100F9240100CF00000001000000000000FA240100FA240100CF00000001000000000000FB240100FB240100CF00000001000000000000FC240100FC240100CF00000001000000000000FD240100FD240100CF00000001000000000000FE240100FE240100CF00000001000000000000FF240100FF240100CF000000010000000000000025010000250100CF000000010000000000000125010001250100CF000000010000000000000225010002250100CF000000010000000000000325010003250100CF000000010000000000000425010004250100CF000000010000000000000525010005250100CF000000010000000000000625010006250100CF000000010000000000000725010007250100CF000000010000000000000825010008250100CF000000010000000000000925010009250100CF000000010000000000000A2501000A250100CF000000010000000000000B2501000B250100CF000000010000000000000C2501000C250100CF000000010000000000000D2501000D250100CF000000010000000000000E2501000E250100CF000000010000000000000F2501000F250100CF000000010000000000001025010010250100CF000000010000000000001125010011250100CF000000010000000000001225010012250100CF000000010000000000001325010013250100CF000000010000000000001425010014250100CF000000010000000000001525010015250100CF000000010000000000001625010016250100CF000000010000000000001725010017250100CF000000010000000000001825010018250100CF000000010000000000001925010019250100CF000000010000000000001A2501001A250100CF000000010000000000001B2501001B250100CF000000010000000000001C2501001C250100CF000000010000000000001D2501001D250100CF000000010000000000001E2501001E250100CF000000010000000000001F2501001F250100CF000000010000000000002025010020250100CF000000010000000000002125010021250100CF000000010000000000002225010022250100CF000000010000000000002325010023250100CF000000010000000000002425010024250100CF000000010000000000002525010025250100CF000000010000000000002625010026250100CF000000010000000000002725010027250100CF000000010000000000002825010028250100CF000000010000000000002925010029250100CF000000010000000000002A2501002A250100CF000000010000000000002B2501002B250100CF000000010000000000002C2501002C250100CF000000010000000000002D2501002D250100CF000000010000000000002E2501002E250100CF000000010000000000002F2501002F250100CF000000010000000000003025010030250100CF000000010000000000003125010031250100CF000000010000000000003225010032250100CF000000010000000000003325010033250100CF000000010000000000003425010034250100CF000000010000000000003525010035250100CF000000010000000000003625010036250100CF000000010000000000003725010037250100CF000000010000000000003825010038250100CF000000010000000000003925010039250100CF000000010000000000003A2501003A250100CF000000010000000000003B2501003B250100CF000000010000000000003C2501003C250100CF000000010000000000003D2501003D250100CF000000010000000000003E2501003E250100CF000000010000000000003F2501003F250100CF000000010000000000004025010040250100CF000000010000000000004125010041250100CF000000010000000000004225010042250100CF000000010000000000004325010043250100CF000000010000000000004425010044250100CF000000010000000000004525010045250100CF000000010000000000004625010046250100CF000000010000000000004725010047250100CF000000010000000000004825010048250100CF000000010000000000004925010049250100CF000000010000000000004A2501004A250100CF000000010000000000004B2501004B250100CF000000010000000000004C2501004C250100CF000000010000000000004D2501004D250100CF000000010000000000004E2501004E250100CF000000010000000000004F2501004F250100CF000000010000000000005025010050250100CF000000010000000000005125010051250100CF000000010000000000005225010052250100CF000000010000000000005325010053250100CF000000010000000000005425010054250100CF000000010000000000005525010055250100CF000000010000000000005625010056250100CF000000010000000000005725010057250100CF000000010000000000005825010058250100CF000000010000000000005925010059250100CF000000010000000000005A2501005A250100CF000000010000000000005B2501005B250100CF000000010000000000005C2501005C250100CF000000010000000000005D2501005D250100CF000000010000000000005E2501005E250100CF000000010000000000005F2501005F250100CF000000010000000000006025010060250100CF000000010000000000006125010061250100CF000000010000000000006225010062250100CF000000010000000000006325010063250100CF000000010000000000006425010064250100CF000000010000000000006525010065250100CF000000010000000000006625010066250100CF000000010000000000006725010067250100CF000000010000000000006825010068250100CF000000010000000000006925010069250100CF000000010000000000006A2501006A250100CF000000010000000000006B2501006B250100CF000000010000000000006C2501006C250100CF000000010000000000006D2501006D250100CF000000010000000000006E2501006E250100CF000000010000000000006F2501006F250100CF000000010000000000007025010070250100CF000000010000000000007125010071250100CF000000010000000000007225010072250100CF000000010000000000007325010073250100CF000000010000000000007425010074250100CF000000010000000000007525010075250100CF000000010000000000007625010076250100CF000000010000000000007725010077250100CF000000010000000000007825010078250100CF000000010000000000007925010079250100CF000000010000000000007A2501007A250100CF000000010000000000007B2501007B250100CF000000010000000000007C2501007C250100CF000000010000000000007D2501007D250100CF000000010000000000007E2501007E250100CF000000010000000000007F2501007F250100CF000000010000000000008025010080250100CF000000010000000000008125010081250100CF000000010000000000008225010082250100CF000000010000000000008325010083250100CF000000010000000000008425010084250100CF000000010000000000008525010085250100CF000000010000000000008625010086250100CF000000010000000000008725010087250100CF000000010000000000008825010088250100CF000000010000000000008925010089250100CF000000010000000000008A2501008A250100CF000000010000000000008B2501008B250100CF000000010000000000008C2501008C250100CF000000010000000000008D2501008D250100CF000000010000000000008E2501008E250100CF000000010000000000008F2501008F250100CF000000010000000000009025010090250100CF000000010000000000009125010091250100CF000000010000000000009225010092250100CF000000010000000000009325010093250100CF000000010000000000009425010094250100CF000000010000000000009525010095250100CF000000010000000000009625010096250100CF000000010000000000009725010097250100CF000000010000000000009825010098250100CF000000010000000000009925010099250100CF000000010000000000009A2501009A250100CF000000010000000000009B2501009B250100CF000000010000000000009C2501009C250100CF000000010000000000009D2501009D250100CF000000010000000000009E2501009E250100CF000000010000000000009F2501009F250100CF00000001000000000000A0250100A0250100CF00000001000000000000A1250100A1250100CF00000001000000000000A2250100A2250100CF00000001000000000000A3250100A3250100CF00000001000000000000A4250100A4250100CF00000001000000000000A5250100A5250100CF00000001000000000000A6250100A6250100CF00000001000000000000A7250100A7250100CF00000001000000000000A8250100A8250100CF00000001000000000000A9250100A9250100CF00000001000000000000AA250100AA250100CF00000001000000000000AB250100AB250100CF00000001000000000000AC250100AC2501006C00000000000000000000AD250100AD2501006C00000000000000000000AE250100AE2501006C00000000000000000000AF250100AF2501006C00000000000000000000B0250100B02501006C00000000000000000000B1250100B12501006C00000000000000000000B2250100B22501006C00000000000000000000B3250100B32501006C00000000000000000000B4250100B42501006C00000000000000000000B5250100B52501006C00000000000000000000B6250100B62501006C00000000000000000000B7250100B72501006C00000000000000000000B8250100B82501006C00000000000000000000B9250100B92501006C00000000000000000000BA250100BA2501006C00000000000000000000BB250100BB2501006C00000000000000000000BC250100BC2501006C00000000000000000000BD250100BD2501006C00000000000000000000BE250100BE2501006C00000000000000000000BF250100BF2501006C00000000000000000000CD250100CD2501007900000000000000000000CE250100CE2501007900000000000000000000CF250100CF2501007900000000000000000000D0250100D02501007900000000000000000000D1250100D12501007900000000000000000000D8250100D82501007900000000000000000000D9250100D92501007900000000000000000000DA250100DA2501007900000000000000000000DB250100DB2501007900000000000000000000DC250100DC2501007900000000000000000000DD250100DD2501007C00000000000000000000DE250100DE2501007C00000000000000000000DF250100DF2501007C00000000000000000000E0250100E02501007C00000000000000000000E1250100E12501007C00000000000000000000E2250100E22501007C00000000000000000000E3250100E32501007C00000000000000000000E4250100E42501007C00000000000000000000EB250100EB2501007C00000000000000000000EC250100EC2501007C00000000000000000000ED250100ED2501006C00000000000000000000EE250100EE2501006C00000000000000000000EF250100EF2501006C00000000000000000000F0250100F02501006C00000000000000000000F1250100F12501006C00000000000000000000F2250100F22501006C00000000000000000000F3250100F32501006C00000000000000000000F4250100F42501006C00000000000000000000F5250100F52501006C00000000000000000000F6250100F62501006C00000000000000000000F7250100F72501006C00000000000000000000F8250100F82501006C00000000000000000000F9250100F92501006C00000000000000000000FA250100FA2501006C00000000000000000000FB250100FB2501006C00000000000000000000FC250100FC2501006C00000000000000000000FD250100FD2501006C00000000000000000000FE250100FE2501006C00000000000000000000FF250100FF2501006C0000000000000000000000260100002601006C000000000000000000000E2601000E26010079000000000000000000000F2601000F2601007900000000000000000000102601001026010079000000000000000000001126010011260100790000000000000000000012260100122601007900000000000000000000192601001926010079000000000000000000001A2601001A26010079000000000000000000001B2601001B26010079000000000000000000001C2601001C26010079000000000000000000001D2601001D26010079000000000000000000001E2601001E2601007C000000000000000000001F2601001F2601007C0000000000000000000020260100202601007C0000000000000000000021260100212601007C0000000000000000000022260100222601007C0000000000000000000023260100232601007C0000000000000000000024260100242601007C0000000000000000000025260100252601007C000000000000000000002C2601002C2601007C000000000000000000002D2601002D2601007C000000000000000000002E2601002E2601006C000000000000000000002F2601002F2601006C0000000000000000000030260100302601006C0000000000000000000031260100312601006C0000000000000000000032260100322601006C0000000000000000000033260100332601006C0000000000000000000034260100342601006C0000000000000000000035260100352601006C0000000000000000000036260100362601006C0000000000000000000037260100372601006C0000000000000000000038260100382601006C0000000000000000000039260100392601006C000000000000000000003A2601003A2601006C000000000000000000003B2601003B2601006C000000000000000000003C2601003C2601006C000000000000000000003D2601003D2601006C000000000000000000003E2601003E2601006C000000000000000000003F2601003F2601006C0000000000000000000040260100402601006C0000000000000000000041260100412601006C000000000000000000004F2601004F2601007900000000000000000000502601005026010079000000000000000000005126010051260100790000000000000000000052260100522601007900000000000000000000532601005326010079000000000000000000005A2601005A26010079000000000000000000005B2601005B26010079000000000000000000005C2601005C26010079000000000000000000005D2601005D26010079000000000000000000005E2601005E26010079000000000000000000005F2601005F2601007C0000000000000000000060260100602601007C0000000000000000000061260100612601007C0000000000000000000062260100622601007C0000000000000000000063260100632601007C0000000000000000000064260100642601007C0000000000000000000065260100652601007C0000000000000000000066260100662601007C000000000000000000006D2601006D2601007C000000000000000000006E2601006E2601007C000000000000000000006F2601006F2601006C0000000000000000000070260100702601006C0000000000000000000071260100712601006C0000000000000000000072260100722601006C0000000000000000000073260100732601006C0000000000000000000074260100742601006C0000000000000000000075260100752601006C0000000000000000000076260100762601006C0000000000000000000077260100772601006C0000000000000000000078260100782601006C0000000000000000000079260100792601006C000000000000000000007A2601007A2601006C000000000000000000007B2601007B2601006C000000000000000000007C2601007C2601006C000000000000000000007D2601007D2601006C000000000000000000007E2601007E2601006C000000000000000000007F2601007F2601006C0000000000000000000080260100802601006C0000000000000000000081260100812601006C0000000000000000000082260100822601006C0000000000000000000090260100902601007900000000000000000000912601009126010079000000000000000000009226010092260100790000000000000000000093260100932601007900000000000000000000942601009426010079000000000000000000009B2601009B26010079000000000000000000009C2601009C26010079000000000000000000009D2601009D26010079000000000000000000009E2601009E26010079000000000000000000009F2601009F2601007900000000000000000000A0260100A02601007C00000000000000000000A1260100A12601007C00000000000000000000A2260100A22601007C00000000000000000000A3260100A32601007C00000000000000000000A4260100A42601007C00000000000000000000A5260100A52601007C00000000000000000000A6260100A62601007C00000000000000000000A7260100A72601007C00000000000000000000AE260100AE2601007C00000000000000000000AF260100AF2601007C00000000000000000000B0260100B02601006C00000000000000000000B1260100B12601006C00000000000000000000B2260100B22601006C00000000000000000000B3260100B32601006C00000000000000000000B4260100B42601006C00000000000000000000B5260100B52601006C00000000000000000000B6260100B62601006C00000000000000000000B7260100B72601006C00000000000000000000B8260100B82601006C00000000000000000000B9260100B92601006C00000000000000000000BA260100BA2601006C00000000000000000000BB260100BB2601006C00000000000000000000BC260100BC2601006C00000000000000000000BD260100BD2601006C00000000000000000000BE260100BE2601006C00000000000000000000BF260100BF2601006C00000000000000000000C0260100C02601006C00000000000000000000C1260100C12601006C00000000000000000000C2260100C22601006C00000000000000000000C3260100C32601006C00000000000000000000D1260100D12601007900000000000000000000D2260100D22601007900000000000000000000D3260100D32601007900000000000000000000D4260100D42601007900000000000000000000D5260100D52601007900000000000000000000DC260100DC2601007900000000000000000000DD260100DD2601007900000000000000000000DE260100DE2601007900000000000000000000DF260100DF2601007900000000000000000000E0260100E02601007900000000000000000000E1260100E12601007C00000000000000000000E2260100E22601007C00000000000000000000E3260100E32601007C00000000000000000000E4260100E42601007C00000000000000000000E5260100E52601007C00000000000000000000E6260100E62601007C00000000000000000000E7260100E72601007C00000000000000000000E8260100E82601007C00000000000000000000EF260100EF2601007C00000000000000000000F0260100F02601007C00000000000000000000F1260100F12601006C00000000000000000000F2260100F22601006C00000000000000000000F3260100F32601006C00000000000000000000F4260100F42601006C00000000000000000000F5260100F52601006C00000000000000000000F6260100F62601006C00000000000000000000F7260100F72601006C00000000000000000000F8260100F82601006C00000000000000000000F9260100F92601006C00000000000000000000FA260100FA2601006C00000000000000000000FB260100FB2601006C00000000000000000000FC260100FC2601006C00000000000000000000FD260100FD2601006C00000000000000000000FE260100FE2601006C00000000000000000000FF260100FF2601006C0000000000000000000000270100002701006C0000000000000000000001270100012701006C0000000000000000000002270100022701006C0000000000000000000003270100032701006C0000000000000000000004270100042701006C0000000000000000000012270100122701007900000000000000000000132701001327010079000000000000000000001427010014270100790000000000000000000015270100152701007900000000000000000000162701001627010079000000000000000000001D2701001D27010079000000000000000000001E2701001E27010079000000000000000000001F2701001F2701007900000000000000000000202701002027010079000000000000000000002127010021270100790000000000000000000022270100222701007C0000000000000000000023270100232701007C0000000000000000000024270100242701007C0000000000000000000025270100252701007C0000000000000000000026270100262701007C0000000000000000000027270100272701007C0000000000000000000028270100282701007C0000000000000000000029270100292701007C0000000000000000000030270100302701007C0000000000000000000031270100312701007C0000000000000000000032270100322701006B0000000100000000000033270100332701006B0000000100000000000034270100342701006B0000000100000000000035270100352701006B0000000100000000000036270100362701006B0000000100000000000037270100372701006B0000000100000000000038270100382701006B0000000100000000000039270100392701006B000000010000000000003A2701003A2701006B000000010000000000003B2701003B2701006B000000010000000000003C2701003C2701006B000000010000000000003D2701003D2701006B000000010000000000003E2701003E2701006B000000010000000000003F2701003F2701006B0000000100000000000040270100402701006B0000000100000000000041270100412701006B0000000100000000000042270100422701006B0000000100000000000043270100432701006B0000000100000000000044270100442701006B0000000100000000000045270100452701006B0000000100000000000046270100462701006B0000000100000000000047270100472701006B0000000100000000000048270100482701006B0000000100000000000049270100492701006B000000010000000000004A2701004A2701006B000000010000000000004B2701004B2701006B000000010000000000004C2701004C2701006B000000010000000000004D2701004D2701006B000000010000000000004E2701004E2701006B000000010000000000004F2701004F2701006B0000000100000000000050270100502701006B0000000100000000000051270100512701006B0000000100000000000052270100522701006B0000000100000000000053270100532701006B0000000100000000000054270100542701006B0000000100000000000055270100552701006B0000000100000000000056270100562701006B0000000100000000000057270100572701006B0000000100000000000058270100582701006B0000000100000000000059270100592701006B000000010000000000005A2701005A2701006B000000010000000000005B2701005B2701006B000000010000000000005C2701005C2701006B000000010000000000005D2701005D2701006B000000010000000000005E2701005E2701006B000000010000000000005F2701005F2701006B0000000100000000000060270100602701006B0000000100000000000061270100612701006B0000000100000000000062270100622701006C0000000000000000000063270100632701006C0000000000000000000064270100642701006C0000000000000000000065270100652701006C0000000000000000000066270100662701006C0000000000000000000067270100672701006C0000000000000000000068270100682701006C0000000000000000000069270100692701006C000000000000000000006A2701006A2701006C000000000000000000006B2701006B2701006C000000000000000000006C2701006C27010079000000000000000000006D2701006D27010079000000000000000000006E2701006E27010079000000000000000000006F2701006F270100790000000000000000000070270100702701007900000000000000000000712701007127010079000000000000000000007227010072270100790000000000000000000073270100732701007900000000000000000000742701007427010079000000000000000000007527010075270100790000000000000000000076270100762701007C0000000000000000000077270100772701007C0000000000000000000078270100782701007C0000000000000000000079270100792701007C000000000000000000007A2701007A2701007C000000000000000000007B2701007B2701007C000000000000000000007C2701007C2701007C000000000000000000007D2701007D2701007C0000000000000000000084270100842701007C0000000000000000000085270100852701007C0000000000000000000086270100862701006C0000000000000000000087270100872701006C0000000000000000000088270100882701006C0000000000000000000089270100892701006C000000000000000000008A2701008A2701006C000000000000000000008B2701008B2701006C000000000000000000008C2701008C2701006C000000000000000000008D2701008D2701006C000000000000000000008E2701008E2701006C000000000000000000008F2701008F2701006C00000000000000000000902701009027010079000000000000000000009127010091270100790000000000000000000092270100922701007900000000000000000000932701009327010079000000000000000000009427010094270100790000000000000000000095270100952701007900000000000000000000962701009627010079000000000000000000009727010097270100790000000000000000000098270100982701007900000000000000000000992701009927010079000000000000000000009A2701009A2701007C000000000000000000009B2701009B2701007C000000000000000000009C2701009C2701007C000000000000000000009D2701009D2701007C000000000000000000009E2701009E2701007C000000000000000000009F2701009F2701007C00000000000000000000A0270100A02701007C00000000000000000000A1270100A12701007C00000000000000000000A8270100A82701007C00000000000000000000A9270100A92701007C00000000000000000000AA270100AA2701006C00000000000000000000AB270100AB2701006C00000000000000000000AC270100AC2701006C00000000000000000000AD270100AD2701006C00000000000000000000AE270100AE2701006C00000000000000000000AF270100AF2701006C00000000000000000000B0270100B02701006C00000000000000000000B1270100B12701006C00000000000000000000B2270100B22701006C00000000000000000000B3270100B32701006C00000000000000000000B4270100B42701007900000000000000000000B5270100B52701007900000000000000000000B6270100B62701007900000000000000000000B7270100B72701007900000000000000000000B8270100B82701007900000000000000000000B9270100B92701007900000000000000000000BA270100BA2701007900000000000000000000BB270100BB2701007900000000000000000000BC270100BC2701007900000000000000000000BD270100BD2701007900000000000000000000BE270100BE2701007C00000000000000000000BF270100BF2701007C00000000000000000000C0270100C02701007C00000000000000000000C1270100C12701007C00000000000000000000C2270100C22701007C00000000000000000000C3270100C32701007C00000000000000000000C4270100C42701007C00000000000000000000C5270100C52701007C00000000000000000000CC270100CC2701007C00000000000000000000CD270100CD2701007C00000000000000000000D4270100D42701006700000001000000000000D5270100D52701006900000001000000000000D6270100D62701006600000001000000000000D7270100D72701006500000001000000000000D8270100D82701006800000001000000000000D9270100D92701006A00000001000000000000DA270100DA2701006700000001000000000000DB270100DB2701006900000001000000000000DC270100DC2701006600000001000000000000DD270100DD2701006500000001000000000000DE270100DE2701006800000001000000000000DF270100DF2701006A00000001000000000000E0270100E02701006700000001000000000000E1270100E12701006900000001000000000000E2270100E22701006600000001000000000000E3270100E32701006500000001000000000000E4270100E42701006800000001000000000000E5270100E52701006A00000001000000000000E6270100E62701006700000001000000000000E7270100E72701006900000001000000000000E8270100E82701006600000001000000000000E9270100E92701006500000001000000000000EA270100EA2701006800000001000000000000EB270100EB2701006A00000001000000000000EC270100EC2701006700000001000000000000ED270100ED2701006900000001000000000000EE270100EE2701006600000001000000000000EF270100EF2701006500000001000000000000F0270100F02701006800000001000000000000F1270100F12701006A00000001000000000000F2270100F22701006700000001000000000000F3270100F32701006900000001000000000000F4270100F42701006600000001000000000000F5270100F52701006500000001000000000000F6270100F62701006800000001000000000000F7270100F72701006A00000001000000000000F8270100F82701006700000001000000000000F9270100F92701006900000001000000000000FA270100FA2701006600000001000000000000FB270100FB2701006500000001000000000000FC270100FC2701006800000001000000000000FD270100FD2701006A00000001000000000000FE270100FE2701006700000001000000000000FF270100FF270100690000000100000000000000280100002801006600000001000000000000012801000128010065000000010000000000000228010002280100680000000100000000000003280100032801006A00000001000000000000042801000428010067000000010000000000000528010005280100690000000100000000000006280100062801006600000001000000000000072801000728010065000000010000000000000828010008280100680000000100000000000009280100092801006A0000000100000000000015280100152801006700000001000000000000162801001628010069000000010000000000001728010017280100660000000100000000000018280100182801006500000001000000000000192801001928010068000000010000000000001A2801001A28010067000000010000000000001B2801001B28010069000000010000000000001C2801001C28010066000000010000000000001D2801001D28010065000000010000000000001E2801001E28010068000000010000000000001F2801001F2801006700000001000000000000202801002028010069000000010000000000002128010021280100660000000100000000000022280100222801006500000001000000000000232801002328010068000000010000000000002428010024280100670000000100000000000025280100252801006900000001000000000000262801002628010066000000010000000000002728010027280100650000000100000000000028280100282801006800000001000000000000292801002928010067000000010000000000002A2801002A28010069000000010000000000002B2801002B28010066000000010000000000002C2801002C28010065000000010000000000002D2801002D28010068000000010000000000002E2801002E28010067000000010000000000002F2801002F2801006900000001000000000000302801003028010066000000010000000000003128010031280100650000000100000000000032280100322801006800000001000000000000332801003328010067000000010000000000003428010034280100690000000100000000000035280100352801006600000001000000000000362801003628010065000000010000000000003728010037280100680000000100000000000038280100382801006700000001000000000000392801003928010069000000010000000000003A2801003A28010066000000010000000000003B2801003B28010065000000010000000000003C2801003C28010068000000010000000000003D2801003D28010067000000010000000000003E2801003E28010069000000010000000000003F2801003F280100660000000100000000000040280100402801006500000001000000000000412801004128010068000000010000000000004D2801004D28010067000000010000000000004E2801004E28010069000000010000000000004F2801004F2801006600000001000000000000502801005028010065000000010000000000005128010051280100680000000100000000000052280100522801006A00000001000000000000532801005328010067000000010000000000005428010054280100690000000100000000000055280100552801006600000001000000000000562801005628010065000000010000000000005728010057280100680000000100000000000058280100582801006A00000001000000000000592801005928010067000000010000000000005A2801005A28010069000000010000000000005B2801005B28010066000000010000000000005C2801005C28010065000000010000000000005D2801005D28010068000000010000000000005E2801005E2801006A000000010000000000005F2801005F28010067000000010000000000006028010060280100690000000100000000000061280100612801006600000001000000000000622801006228010065000000010000000000006328010063280100680000000100000000000064280100642801006A0000000100000000000065280100652801006700000001000000000000662801006628010069000000010000000000006728010067280100660000000100000000000068280100682801006500000001000000000000692801006928010068000000010000000000006A2801006A2801006A000000010000000000006B2801006B28010067000000010000000000006C2801006C28010069000000010000000000006D2801006D28010066000000010000000000006E2801006E28010065000000010000000000006F2801006F280100680000000100000000000070280100702801006A00000001000000000000712801007128010067000000010000000000007228010072280100690000000100000000000073280100732801006600000001000000000000742801007428010065000000010000000000007528010075280100680000000100000000000076280100762801006A000000010000000000007728010077280100670000000100000000000078280100782801006900000001000000000000792801007928010066000000010000000000007A2801007A28010065000000010000000000007B2801007B28010068000000010000000000007C2801007C2801006A000000010000000000007D2801007D28010067000000010000000000007E2801007E28010069000000010000000000007F2801007F2801006600000001000000000000802801008028010065000000010000000000008128010081280100680000000100000000000082280100822801006A000000010000000000008D2801008D28010067000000010000000000008E2801008E28010069000000010000000000008F2801008F2801006500000001000000000000902801009028010068000000010000000000009128010091280100670000000100000000000092280100922801006900000001000000000000932801009328010065000000010000000000009428010094280100680000000100000000000095280100952801006700000001000000000000962801009628010069000000010000000000009728010097280100650000000100000000000098280100982801006800000001000000000000992801009928010067000000010000000000009A2801009A28010069000000010000000000009B2801009B28010065000000010000000000009C2801009C28010068000000010000000000009D2801009D28010067000000010000000000009E2801009E28010069000000010000000000009F2801009F2801006500000001000000000000A0280100A02801006800000001000000000000A1280100A12801006700000001000000000000A2280100A22801006900000001000000000000A3280100A32801006500000001000000000000A4280100A42801006800000001000000000000A5280100A52801006700000001000000000000A6280100A62801006900000001000000000000A7280100A72801006500000001000000000000A8280100A82801006800000001000000000000A9280100A92801006700000001000000000000AA280100AA2801006900000001000000000000AB280100AB2801006500000001000000000000AC280100AC2801006800000001000000000000AD280100AD2801006700000001000000000000AE280100AE2801006900000001000000000000AF280100AF2801006500000001000000000000B0280100B02801006800000001000000000000B5280100B52801006700000001000000000000B6280100B62801006900000001000000000000B7280100B72801006600000001000000000000B8280100B82801006500000001000000000000B9280100B92801006800000001000000000000BA280100BA2801006800000001000000000000BB280100BB2801006700000001000000000000BC280100BC2801006900000001000000000000BD280100BD2801006600000001000000000000BE280100BE2801006500000001000000000000BF280100BF2801006800000001000000000000C0280100C02801006800000001000000000000C1280100C12801006700000001000000000000C2280100C22801006900000001000000000000C3280100C32801006600000001000000000000C4280100C42801006500000001000000000000C5280100C52801006800000001000000000000C6280100C62801006800000001000000000000C7280100C72801006700000001000000000000C8280100C82801006900000001000000000000C9280100C92801006600000001000000000000CA280100CA2801006500000001000000000000CB280100CB2801006800000001000000000000CC280100CC2801006800000001000000000000CD280100CD2801006700000001000000000000CE280100CE2801006900000001000000000000CF280100CF2801006900000001000000000000D0280100D02801006600000001000000000000D1280100D12801006500000001000000000000D2280100D22801006800000001000000000000D3280100D32801006800000001000000000000D4280100D42801006700000001000000000000D5280100D52801006900000001000000000000D6280100D62801006900000001000000000000D7280100D72801006600000001000000000000D8280100D82801006500000001000000000000D9280100D92801006800000001000000000000DA280100DA2801006800000001000000000000DB280100DB2801006700000001000000000000DC280100DC2801006900000001000000000000DD280100DD2801006900000001000000000000DE280100DE2801006600000001000000000000DF280100DF2801006500000001000000000000E0280100E02801006800000001000000000000E1280100E12801006800000001000000000000E2280100E22801006700000001000000000000E3280100E32801006900000001000000000000E4280100E42801006900000001000000000000E5280100E52801006600000001000000000000E6280100E62801006500000001000000000000E7280100E72801006800000001000000000000E8280100E82801006800000001000000000000E9280100E92801006700000001000000000000EA280100EA2801006900000001000000000000EB280100EB2801006900000001000000000000EC280100EC2801006600000001000000000000ED280100ED2801006500000001000000000000EE280100EE2801006800000001000000000000EF280100EF2801006800000001000000000000F0280100F02801006700000001000000000000F1280100F12801006900000001000000000000F2280100F22801006900000001000000000000F3280100F32801006600000001000000000000F4280100F42801006500000001000000000000F5280100F52801006800000001000000000000F6280100F62801006800000001000000000000002901000029010067000000010000000000000129010001290100690000000100000000000002290100022901006500000001000000000000032901000329010068000000010000000000000429010004290100670000000100000000000005290100052901006900000001000000000000062901000629010065000000010000000000000729010007290100680000000100000000000008290100082901006700000001000000000000092901000929010069000000010000000000000A2901000A29010065000000010000000000000B2901000B29010068000000010000000000000C2901000C29010067000000010000000000000D2901000D29010069000000010000000000000E2901000E29010065000000010000000000000F2901000F2901006800000001000000000000102901001029010067000000010000000000001129010011290100690000000100000000000012290100122901006500000001000000000000132901001329010068000000010000000000001429010014290100670000000100000000000015290100152901006900000001000000000000162901001629010065000000010000000000001729010017290100680000000100000000000018290100182901006700000001000000000000192901001929010069000000010000000000001A2901001A29010065000000010000000000001B2901001B29010068000000010000000000001C2901001C29010067000000010000000000001D2901001D29010069000000010000000000001E2901001E29010065000000010000000000001F2901001F2901006800000001000000000000202901002029010067000000010000000000002129010021290100690000000100000000000022290100222901006500000001000000000000232901002329010068000000010000000000002E2901002E29010067000000010000000000002F2901002F290100690000000100000000000030290100302901006600000001000000000000312901003129010065000000010000000000003229010032290100680000000100000000000033290100332901006A00000001000000000000342901003429010067000000010000000000003529010035290100690000000100000000000036290100362901006600000001000000000000372901003729010065000000010000000000003829010038290100680000000100000000000039290100392901006A000000010000000000003A2901003A29010067000000010000000000003B2901003B29010069000000010000000000003C2901003C29010066000000010000000000003D2901003D29010065000000010000000000003E2901003E29010068000000010000000000003F2901003F2901006A00000001000000000000402901004029010067000000010000000000004129010041290100690000000100000000000042290100422901006600000001000000000000432901004329010065000000010000000000004429010044290100680000000100000000000045290100452901006A00000001000000000000462901004629010067000000010000000000004729010047290100690000000100000000000048290100482901006600000001000000000000492901004929010065000000010000000000004A2901004A29010068000000010000000000004B2901004B2901006A000000010000000000004C2901004C29010067000000010000000000004D2901004D29010069000000010000000000004E2901004E29010066000000010000000000004F2901004F29010065000000010000000000005029010050290100680000000100000000000051290100512901006A00000001000000000000522901005229010067000000010000000000005329010053290100690000000100000000000054290100542901006600000001000000000000552901005529010065000000010000000000005629010056290100680000000100000000000057290100572901006A0000000100000000000058290100582901006700000001000000000000592901005929010069000000010000000000005A2901005A29010066000000010000000000005B2901005B29010065000000010000000000005C2901005C29010068000000010000000000005D2901005D2901006A000000010000000000005E2901005E29010067000000010000000000005F2901005F290100690000000100000000000060290100602901006600000001000000000000612901006129010065000000010000000000006229010062290100680000000100000000000063290100632901006A00000001000000000000702901007029010067000000010000000000007129010071290100690000000100000000000072290100722901006600000001000000000000732901007329010065000000010000000000007429010074290100680000000100000000000075290100752901006A00000001000000000000762901007629010067000000010000000000007729010077290100690000000100000000000078290100782901006600000001000000000000792901007929010065000000010000000000007A2901007A29010068000000010000000000007B2901007B2901006A000000010000000000007C2901007C29010067000000010000000000007D2901007D29010069000000010000000000007E2901007E29010066000000010000000000007F2901007F29010065000000010000000000008029010080290100680000000100000000000081290100812901006A00000001000000000000822901008229010067000000010000000000008329010083290100690000000100000000000084290100842901006600000001000000000000852901008529010065000000010000000000008629010086290100680000000100000000000087290100872901006A0000000100000000000088290100882901006700000001000000000000892901008929010069000000010000000000008A2901008A29010066000000010000000000008B2901008B29010065000000010000000000008C2901008C29010068000000010000000000008D2901008D2901006A000000010000000000008E2901008E29010067000000010000000000008F2901008F290100690000000100000000000090290100902901006600000001000000000000912901009129010065000000010000000000009229010092290100680000000100000000000093290100932901006A00000001000000000000942901009429010067000000010000000000009529010095290100690000000100000000000096290100962901006600000001000000000000972901009729010065000000010000000000009829010098290100680000000100000000000099290100992901006A000000010000000000009A2901009A29010067000000010000000000009B2901009B29010069000000010000000000009C2901009C29010066000000010000000000009D2901009D29010065000000010000000000009E2901009E2901006A000000010000000000009F2901009F2901006700000001000000000000A0290100A02901006900000001000000000000A1290100A12901006600000001000000000000A2290100A22901006500000001000000000000A3290100A32901006A00000001000000000000B0290100B02901006700000001000000000000B1290100B12901006900000001000000000000B2290100B22901006600000001000000000000B3290100B32901006500000001000000000000B4290100B42901006800000001000000000000B5290100B52901006A00000001000000000000B6290100B62901006700000001000000000000B7290100B72901006600000001000000000000B8290100B82901006500000001000000000000B9290100B92901006900000001000000000000BA290100BA2901006800000001000000000000BB290100BB2901006A00000001000000000000BC290100BC2901006700000001000000000000BD290100BD2901006900000001000000000000BE290100BE2901006600000001000000000000BF290100BF2901006500000001000000000000C0290100C02901006800000001000000000000C1290100C12901006A00000001000000000000C2290100C22901006700000001000000000000C3290100C32901006900000001000000000000C4290100C42901006600000001000000000000C5290100C52901006500000001000000000000C6290100C62901006800000001000000000000C7290100C72901006A00000001000000000000C8290100C82901006700000001000000000000C9290100C92901006900000001000000000000CA290100CA2901006600000001000000000000CB290100CB2901006500000001000000000000CC290100CC2901006800000001000000000000CD290100CD2901006A00000001000000000000CE290100CE2901006700000001000000000000CF290100CF2901006900000001000000000000D0290100D02901006600000001000000000000D1290100D12901006500000001000000000000D2290100D22901006800000001000000000000D3290100D32901006A00000001000000000000D4290100D42901006700000001000000000000D5290100D52901006900000001000000000000D6290100D62901006600000001000000000000D7290100D72901006500000001000000000000D8290100D82901006800000001000000000000D9290100D92901006A00000001000000000000DA290100DA2901006700000001000000000000DB290100DB2901006900000001000000000000DC290100DC2901006600000001000000000000DD290100DD2901006500000001000000000000DE290100DE2901006800000001000000000000DF290100DF2901006A00000001000000000000E0290100E02901006700000001000000000000E1290100E12901006900000001000000000000E2290100E22901006600000001000000000000E3290100E32901006500000001000000000000E4290100E42901006800000001000000000000E5290100E52901006A00000001000000000000F0290100F02901006700000001000000000000F1290100F12901006900000001000000000000F2290100F22901006500000001000000000000F3290100F32901006800000001000000000000F4290100F42901006700000001000000000000F5290100F52901006900000001000000000000F6290100F62901006500000001000000000000F7290100F72901006800000001000000000000F8290100F82901006700000001000000000000F9290100F92901006900000001000000000000FA290100FA2901006500000001000000000000FB290100FB2901006800000001000000000000FC290100FC2901006700000001000000000000FD290100FD2901006900000001000000000000FE290100FE2901006500000001000000000000FF290100FF2901006800000001000000000000002A0100002A01006700000001000000000000012A0100012A01006900000001000000000000022A0100022A01006500000001000000000000032A0100032A01006800000001000000000000042A0100042A01006700000001000000000000052A0100052A01006900000001000000000000062A0100062A01006500000001000000000000072A0100072A01006800000001000000000000082A0100082A01006700000001000000000000092A0100092A010069000000010000000000000A2A01000A2A010065000000010000000000000B2A01000B2A010068000000010000000000000C2A01000C2A010067000000010000000000000D2A01000D2A010069000000010000000000000E2A01000E2A010065000000010000000000000F2A01000F2A01006800000001000000000000102A0100102A01006700000001000000000000112A0100112A01006900000001000000000000122A0100122A01006500000001000000000000132A0100132A010068000000010000000000001E2A01001E2A010067000000010000000000001F2A01001F2A01006900000001000000000000202A0100202A01006600000001000000000000212A0100212A01006500000001000000000000222A0100222A01006800000001000000000000232A0100232A01006A00000001000000000000242A0100242A01006700000001000000000000252A0100252A01006900000001000000000000262A0100262A01006600000001000000000000272A0100272A01006500000001000000000000282A0100282A01006800000001000000000000292A0100292A01006A000000010000000000002A2A01002A2A010067000000010000000000002B2A01002B2A010069000000010000000000002C2A01002C2A010066000000010000000000002D2A01002D2A010065000000010000000000002E2A01002E2A010068000000010000000000002F2A01002F2A01006A00000001000000000000302A0100302A01006700000001000000000000312A0100312A01006900000001000000000000322A0100322A01006600000001000000000000332A0100332A01006500000001000000000000342A0100342A01006800000001000000000000352A0100352A01006A00000001000000000000362A0100362A01006700000001000000000000372A0100372A01006900000001000000000000382A0100382A01006600000001000000000000392A0100392A010065000000010000000000003A2A01003A2A010068000000010000000000003B2A01003B2A01006A000000010000000000003C2A01003C2A010067000000010000000000003D2A01003D2A010069000000010000000000003E2A01003E2A010066000000010000000000003F2A01003F2A01006500000001000000000000402A0100402A01006800000001000000000000412A0100412A01006A00000001000000000000422A0100422A01006700000001000000000000432A0100432A01006900000001000000000000442A0100442A01006600000001000000000000452A0100452A01006500000001000000000000462A0100462A01006800000001000000000000472A0100472A01006A00000001000000000000482A0100482A01006700000001000000000000492A0100492A010069000000010000000000004A2A01004A2A010066000000010000000000004B2A01004B2A010065000000010000000000004C2A01004C2A010068000000010000000000004D2A01004D2A01006A000000010000000000004E2A01004E2A010067000000010000000000004F2A01004F2A01006900000001000000000000502A0100502A01006600000001000000000000512A0100512A01006500000001000000000000522A0100522A01006800000001000000000000532A0100532A01006A00000001000000000000622A0100622A01006700000001000000000000632A0100632A01006900000001000000000000642A0100642A01006900000001000000000000652A0100652A01006600000001000000000000662A0100662A01006500000001000000000000672A0100672A01006800000001000000000000682A0100682A01006800000001000000000000692A0100692A01006A000000010000000000006A2A01006A2A010067000000010000000000006B2A01006B2A010069000000010000000000006C2A01006C2A010069000000010000000000006D2A01006D2A010066000000010000000000006E2A01006E2A010065000000010000000000006F2A01006F2A01006800000001000000000000702A0100702A01006800000001000000000000712A0100712A01006A00000001000000000000722A0100722A01006700000001000000000000732A0100732A01006900000001000000000000742A0100742A01006900000001000000000000752A0100752A01006600000001000000000000762A0100762A01006500000001000000000000772A0100772A01006800000001000000000000782A0100782A01006800000001000000000000792A0100792A01006A000000010000000000007A2A01007A2A010067000000010000000000007B2A01007B2A010069000000010000000000007C2A01007C2A010069000000010000000000007D2A01007D2A010066000000010000000000007E2A01007E2A010065000000010000000000007F2A01007F2A01006800000001000000000000802A0100802A01006800000001000000000000812A0100812A01006A00000001000000000000822A0100822A01006700000001000000000000832A0100832A01006900000001000000000000842A0100842A01006900000001000000000000852A0100852A01006600000001000000000000862A0100862A01006500000001000000000000872A0100872A01006800000001000000000000882A0100882A01006800000001000000000000892A0100892A01006A000000010000000000008A2A01008A2A010067000000010000000000008B2A01008B2A010069000000010000000000008C2A01008C2A010069000000010000000000008D2A01008D2A010066000000010000000000008E2A01008E2A010065000000010000000000008F2A01008F2A01006800000001000000000000902A0100902A01006800000001000000000000912A0100912A01006A00000001000000000000922A0100922A01006700000001000000000000932A0100932A01006900000001000000000000942A0100942A01006900000001000000000000952A0100952A01006600000001000000000000962A0100962A01006500000001000000000000972A0100972A01006800000001000000000000982A0100982A01006800000001000000000000992A0100992A01006A000000010000000000009A2A01009A2A010067000000010000000000009B2A01009B2A010069000000010000000000009C2A01009C2A010069000000010000000000009D2A01009D2A010066000000010000000000009E2A01009E2A010065000000010000000000009F2A01009F2A01006800000001000000000000A02A0100A02A01006800000001000000000000A12A0100A12A01006A00000001000000000000A22A0100A22A01006700000001000000000000A32A0100A32A01006900000001000000000000A42A0100A42A01006900000001000000000000A52A0100A52A01006600000001000000000000A62A0100A62A01006500000001000000000000A72A0100A72A01006800000001000000000000A82A0100A82A01006800000001000000000000A92A0100A92A01006A00000001000000000000B92A0100B92A01006900000001000000000000BA2A0100BA2A01006800000001000000000000BB2A0100BB2A01006800000001000000000000BC2A0100BC2A01006800000001000000000000BD2A0100BD2A01006700000001000000000000BE2A0100BE2A01006700000001000000000000BF2A0100BF2A01006700000001000000000000C02A0100C02A01006900000001000000000000C12A0100C12A01006900000001000000000000C22A0100C22A01006900000001000000000000C32A0100C32A01006800000001000000000000C42A0100C42A01006800000001000000000000C52A0100C52A01006800000001000000000000C62A0100C62A01006700000001000000000000C72A0100C72A01006700000001000000000000C82A0100C82A01006700000001000000000000C92A0100C92A01006700000001000000000000CA2A0100CA2A01006700000001000000000000CB2A0100CB2A01006700000001000000000000CC2A0100CC2A01006900000001000000000000CD2A0100CD2A01006900000001000000000000CE2A0100CE2A01006900000001000000000000CF2A0100CF2A01006800000001000000000000D02A0100D02A01006800000001000000000000D12A0100D12A01006700000001000000000000D22A0100D22A01006800000001000000000000D32A0100D32A01006900000001000000000000D42A0100D42A01006700000001000000000000D52A0100D52A01006800000001000000000000D62A0100D62A01006900000001000000000000D72A0100D72A01006700000001000000000000D82A0100D82A01006800000001000000000000D92A0100D92A01006900000001000000000000DB2A0100DB2A01006C00000000000000000000DC2A0100DC2A01006C00000000000000000000DD2A0100DD2A01006C00000000000000000000DE2A0100DE2A01006C00000000000000000000DF2A0100DF2A01006C00000000000000000000E02A0100E02A01006C00000000000000000000E12A0100E12A01006C00000000000000000000E22A0100E22A01006C00000000000000000000E32A0100E32A01006C00000000000000000000E42A0100E42A01006C00000000000000000000E52A0100E52A01007900000000000000000000E62A0100E62A01007900000000000000000000E72A0100E72A01007900000000000000000000E82A0100E82A01007900000000000000000000E92A0100E92A01007900000000000000000000EA2A0100EA2A01007900000000000000000000EB2A0100EB2A01007900000000000000000000EC2A0100EC2A01007900000000000000000000ED2A0100ED2A01007900000000000000000000EE2A0100EE2A01007900000000000000000000662B0100662B01006700000001000000000000672B0100672B01006700000001000000000000682B0100682B01006700000001000000000000692B0100692B010067000000010000000000006A2B01006A2B010067000000010000000000006B2B01006B2B010067000000010000000000006C2B01006C2B010067000000010000000000006D2B01006D2B010067000000010000000000006E2B01006E2B010067000000010000000000006F2B01006F2B01006900000001000000000000702B0100702B01006900000001000000000000712B0100712B01006900000001000000000000722B0100722B01006900000001000000000000732B0100732B01006900000001000000000000742B0100742B01006900000001000000000000752B0100752B01006900000001000000000000762B0100762B01006900000001000000000000772B0100772B01006500000001000000000000782B0100782B01006500000001000000000000792B0100792B010065000000010000000000007A2B01007A2B010065000000010000000000007B2B01007B2B010065000000010000000000007C2B01007C2B010065000000010000000000007D2B01007D2B010065000000010000000000007E2B01007E2B010065000000010000000000007F2B01007F2B01006800000001000000000000802B0100802B01006800000001000000000000812B0100812B01006800000001000000000000822B0100822B01006800000001000000000000832B0100832B01006800000001000000000000842B0100842B01006800000001000000000000852B0100852B01006800000001000000000000862B0100862B01006800000001000000000000872B0100872B01006A00000001000000000000882B0100882B01006A00000001000000000000892B0100892B01006A000000010000000000008A2B01008A2B01006A000000010000000000008B2B01008B2B01006A000000010000000000008C2B01008C2B01006A000000010000000000008D2B01008D2B01006A000000010000000000008E2B01008E2B01006A000000010000000000008F2B01008F2B01006B00000001000000000000902B0100902B01006B00000001000000000000912B0100912B01006B00000001000000000000922B0100922B01006B00000001000000000000932B0100932B01006B00000001000000000000942B0100942B01006700000001000000000000952B0100952B01006900000001000000000000962B0100962B01006500000001000000000000972B0100972B01006800000001000000000000982B0100982B01006700000001000000000000992B0100992B010069000000010000000000009A2B01009A2B010065000000010000000000009B2B01009B2B010068000000010000000000009C2B01009C2B010067000000010000000000009D2B01009D2B010069000000010000000000009E2B01009E2B010065000000010000000000009F2B01009F2B01006800000001000000000000A92B0100A92B01000A00000000000000000000EA2B0100EA2B01003300000001000000000000EC2B0100EC2B01003300000001000000000000EF2B0100EF2B01003700000001000000000000F12B0100F12B01003700000001000000000000F42B0100F42B01003B00000001000000000000FF2B0100FF2B01003B00000001000000000000C92C0100C92C01000600000001000000000000CA2C0100CA2C01000600000001000000000000CB2C0100CB2C01000600000001000000000000CC2C0100CC2C01000600000001000000000000CD2C0100CD2C01000600000001000000000000CE2C0100CE2C01000600000001000000000000CF2C0100CF2C01000600000001000000000000D02C0100D02C01000600000001000000000000D12C0100D12C01000600000001000000000000D22C0100D22C01000600000001000000000000D52C0100D52C01000600000001000000000000D62C0100D62C01000600000001000000000000D72C0100D72C01000600000001000000000000D82C0100D82C01000600000001000000000000D92C0100D92C01000600000001000000000000DA2C0100DA2C01000600000001000000000000DB2C0100DB2C01000600000001000000000000DC2C0100DC2C01000600000001000000000000DD2C0100DD2C01000600000001000000000000DE2C0100DE2C01000600000001000000000000DF2C0100DF2C01000600000001000000000000E22C0100E22C01000600000001000000000000722E0100722E01000600000001000000000000732E0100732E01000600000001000000000000742E0100742E01000600000001000000000000752E0100752E01000600000001000000000000762E0100762E01000600000001000000000000772E0100772E01000600000001000000000000782E0100782E01000600000001000000000000792E0100792E010006000000010000000000007A2E01007A2E01006500000001000000000000E0320100E03201000000000001000000000001EB320100EB32010065000000000000000000001233010012330100670000000100000000000044330100443301002D0100000000000000000045330100453301002D0100000000000000000046330100463301002D01000000000000000000A1340100A13401000000000000000000000001CA340100CA34010000000000000000000000011D3501001D3501006500000000000000000000E70000004D0000004D00000013000000000000000100004C0300004C03000011000000000000000000004D0300004D03000011000000000000000000005003000050030000110000000000000000000051030000510300001100000000000000000000530300005303000011000000000000000000005403000054030000110000000000000000000056030000560300001100000000000000000000590300005903000011000000000000000000005B0300005B03000011000000000000000000005F0300005F03000011000000000000000000006103000061030000110000000000000000000063030000630300001100000000000000000000E0080000E0080000C800000000000000000000CC090000CC0900001100000000000000000000D2090000D20900001100000000000000010000D7090000D70900001100000000000000010000DB090000DB0900001100000000000000010000DD090000DD0900001100000000000000010000CE1E0000CE1E0000C800000000000000000000D01E0000D01E0000C800000000000000000000D11E0000D11E0000C800000000000000000000672800006728000093000000010000000000009328000093280000C800000000000000000000E5280000E5280000C800000000000000000000E8280000E82800003900000001000000000000C5410000C54100003800000001000000000000DA410000DA4100003800000000000000000000DB410000DB4100003800000000000000000000DC410000DC4100003800000000000000000000DE410000DE41000039000000000000000000006A4400006A440000C8000000000000000000006C4400006C440000C8000000000000000000006D4400006D440000C8000000000000000000007044000070440000C8000000000000000000007244000072440000C8000000000000000000008044000080440000C8000000000000000000009444000094440000C800000000000000000000BD440000BD44000003000000000000000000004E4500004E4500003600000000000000000000564500005645000036000000000000000000005745000057450000360000000000000000000058450000584500003600000001000000000000594500005945000036000000000000000000005B4500005B4500003600000000000000000000B6460000B64600003900000000000000000000B7460000B74600003900000000000000000000B8460000B84600003900000000000000000000B9460000B94600003900000000000000000000BC460000BC4600003500000001000000000000BF460000BF4600003900000001000000000000C3460000C34600003900000001000000000000C4460000C44600003900000001000000000000C5460000C54600003900000000000000000000C6460000C64600003900000000000000000000CC460000CC4600003900000001000000000000D3460000D34600003800000001000000000000D6460000D64600003800000001000000000000DC460000DC4600003800000001000000000000E1460000E14600003900000001000000000000E3460000E34600003900000001000000000000E4460000E44600003800000001000000000000E9460000E94600003900000001000000000000EA460000EA4600003900000001000000000000EB460000EB4600003900000001000000000000EE460000EE4600003900000001000000000000BC5C0000BC5C000013000000000000000100007D7700007D770000C8000000000000000000000D8C00000D8C00003E000000000000000000000E8C00000E8C00003E000000000000000100000F8C00000F8C00003E00000000000000010000108C0000108C00003E00000000000000010000118C0000118C00003E00000000000000010000128C0000128C00003E00000000000000010000138C0000138C00003E00000000000000010000148C0000148C00003E00000000000000010000158C0000158C00003E00000000000000010000168C0000168C00003E00000000000000010000EE8D0000EE8D0000040000000B000000000000EF8D0000EF8D0000040000000B000000000000F08D0000F08D0000040000000B000000000000F18D0000F18D0000040000000B000000000000F28D0000F28D0000040000000B000000000000F38D0000F38D0000040000000B000000000000F48D0000F48D0000040000000B000000000000F58D0000F58D0000040000000B000000000000F68D0000F68D0000040000000B000000000000F78D0000F78D0000040000000B000000000000F88D0000F88D0000040000000B000000000000F98D0000F98D0000040000000B000000000000FA8D0000FA8D0000040000000B000000000000FB8D0000FB8D0000040000000B000000000000FC8D0000FC8D0000040000000B000000000000FD8D0000FD8D0000040000000B000000000000FE8D0000FE8D0000040000000B000000000000FF8D0000FF8D0000040000000B000000000000008E0000008E0000040000000B000000000000018E0000018E0000040000000B000000000000028E0000028E0000040000000B000000000000038E0000038E0000040000000B000000000000048E0000048E0000040000000B000000000000058E0000058E0000040000000B000000000000068E0000068E0000040000000B000000000000078E0000078E0000040000000B000000000000088E0000088E0000040000000B000000000000098E0000098E0000040000000B0000000000000A8E00000A8E0000040000000B0000000000000B8E00000B8E0000040000000B0000000000000C8E00000C8E0000040000000B0000000000000D8E00000D8E0000040000000B0000000000000E8E00000E8E0000040000000B0000000000000F8E00000F8E0000040000000B000000000000108E0000108E0000040000000B0000000000007F8E00007F8E00003500000001000000000000838E0000838E00003500000001000000000000858E0000858E00003500000001000000000000888E0000888E000035000000010000000000008A8E00008A8E000035000000010000000000008B8E00008B8E000035000000010000000000008D8E00008D8E000035000000010000000000008E8E00008E8E00003500000001000000000000938E0000938E000035000000010000000000009D8E00009D8E00003500000001000000000000A18E0000A18E00003500000001000000000000A28E0000A28E00003500000001000000000000A98E0000A98E00003500000001000000000000AB8E0000AB8E00003500000001000000000000B38E0000B38E00003500000001000000000000B48E0000B48E00003500000001000000000000B68E0000B68E00003500000001000000000000BC8E0000BC8E00003500000001000000000000C18E0000C18E00003500000001000000000000C28E0000C28E00003500000001000000000000C58E0000C58E00003500000001000000000000CB8E0000CB8E00003500000001000000000000DA8E0000DA8E00003500000001000000000000E08E0000E08E00003500000001000000000000E48E0000E48E00003500000001000000000000F28E0000F28E00003500000001000000000000F48E0000F48E00003500000001000000000000FB8E0000FB8E00003500000001000000000000FE8E0000FE8E000035000000010000000000000990000009900000040000000B0000000000000A9000000A900000040000000B0000000000000B9000000B900000040000000B0000000000000C9000000C900000040000000B0000000000000D9000000D900000040000000B0000000000000E9000000E900000040000000B0000000000000F9000000F900000040000000B0000000000001090000010900000040000000B0000000000001190000011900000040000000B0000000000001290000012900000040000000B0000000000001390000013900000040000000B0000000000001490000014900000040000000B0000000000001590000015900000040000000B0000000000001690000016900000040000000B0000000000001790000017900000040000000B0000000000001990000019900000040000000B0000000000001A9000001A900000040000000B0000000000001B9000001B900000040000000B0000000000001C9000001C900000040000000B0000000000001D9000001D900000040000000B0000000000001E9000001E900000040000000B0000000000001F9000001F900000040000000B0000000000002090000020900000040000000B0000000000002190000021900000040000000B0000000000002290000022900000040000000B0000000000002390000023900000040000000B0000000000002490000024900000040000000B0000000000002590000025900000040000000B0000000000002690000026900000040000000B0000000000002790000027900000040000000B0000000000002890000028900000040000000B0000000000002990000029900000040000000B0000000000002A9000002A900000040000000B0000000000002B9000002B900000040000000B0000000000002C9000002C900000040000000B0000000000002D9000002D900000040000000B0000000000002E9000002E900000040000000B0000000000002F9000002F900000040000000B0000000000003090000030900000040000000B0000000000003190000031900000040000000B0000000000004190000041900000040000000B0000000000004290000042900000040000000B0000000000004390000043900000040000000B0000000000004490000044900000040000000B0000000000004590000045900000040000000B00000000000022B0000022B00000130000000000000001000023B0000023B000001300000000000000010000C7BC0000C7BC00001300000000000000010000E6C00000E6C000001100000000000000010000E7C00000E7C000001100000000000000010000E8C00000E8C000001100000000000000010000E9C00000E9C000001100000000000000010000C5C10000C5C100001300000000000000010000E2320100E23201006700000001000000000000E6320100E63201006700000001000000000000F3320100F33201003500000000000000000000F6320100F63201003600000000000000000000F7320100F73201003600000000000000000000F9320100F9320100650000000000000000000022330100223301006700000016000000000000233301002333010069000000160000000000002433010024330100660000001600000000000025330100253301006500000016000000000000263301002633010068000000160000000000002733010027330100670000001700000000000028330100283301006900000017000000000000293301002933010066000000170000000000002A3301002A33010065000000170000000000002B3301002B3301006800000017000000000000093501000935010067000000160000000000000A3501000A35010069000000160000000000000B3501000B35010066000000160000000000000C3501000C35010065000000160000000000000D3501000D35010068000000160000000000000E3501000E35010067000000160000000000000F3501000F3501006900000016000000000000103501001035010066000000160000000000001135010011350100650000001600000000000012350100123501006800000016000000000000133501001335010067000000170000000000001435010014350100690000001700000000000015350100153501006600000017000000000000163501001635010065000000170000000000001735010017350100680000001700000000000018350100183501006700000017000000000000193501001935010069000000170000000000001A3501001A35010066000000170000000000001B3501001B35010065000000170000000000001C3501001C3501006800000017000000000000"));
            SendTunneledClientPacket(soeClient, StringToByteArray(/* AdventurersJournalInfoPacket */"D1000100000004000000010000000100000025D24D00FFD14D00798A000000000000F400000060D74D0002000000020000000BBF060000D24D003C250000000000000500000039C106000300000003000000AD0D00005108000042250000000000000800000061D74D000400000004000000B10D00003DC106003925000000000000010000003EC106000A0000000100000001000000010000000100000068BF06001300000014AD000016AD000027D24D000000000000000000020000000200000001000000020000002F4900001300000014AD000017AD000028D24D0000000000000000000300000003000000010000000300000025D24D001300000014AD000015AD000029D24D000000000000000000040000000400000002000000010000005E1C00001300000014AD00008DAF00000DBF0600000000000000000005000000050000000200000002000000C38B06001300000014AD00008EAF00000EBF06000000000000000000060000000600000002000000030000000CBF06001300000014AD000091AF00000FBF06000000000000000000070000000700000002000000040000004C1100001300000014AD00008FAF000010BF0600000000000000000008000000080000000300000001000000FFD84D001300000014AD0000D3B0000000D94D0000000000000000000900000009000000030000000200000001D94D001300000014AD0000D4B0000002D94D0000000000000000000A0000000A0000000400000001000000FFC006001300000014AD000020B200003FC1060000000000000000003A000000D209000001000000D209000002000000D109000001000000D109000001000000D909000002000000D909000002000000DE09000002000000DE09000007000000DA09000002000000DA09000003000000DB09000002000000DB09000004000000DC09000002000000DC09000005000000DD09000002000000DD09000006000000E109000003000000E109000003000000E009000003000000E009000002000000DF09000003000000DF09000001000000060A000003000000060A000005000000E209000003000000E209000004000000BD09000004000000BD09000006000000BC09000004000000BC09000005000000BB09000004000000BB09000004000000BA09000004000000BA09000003000000B909000004000000B909000002000000EA09000004000000EA09000001000000C209000005000000C209000006000000C109000005000000C109000005000000C009000005000000C009000004000000BF09000005000000BF09000003000000BE09000005000000BE09000002000000E309000005000000E309000001000000C609000006000000C609000004000000C509000006000000C509000003000000C409000006000000C409000002000000C309000006000000C309000001000000C709000006000000C709000005000000E509000007000000E509000007000000E409000007000000E409000001000000C809000007000000C809000002000000CC09000007000000CC09000006000000CB09000007000000CB09000005000000C909000007000000C909000003000000CA09000007000000CA09000004000000140A000008000000140A000005000000120A000008000000120A000003000000130A000008000000130A000004000000110A000008000000110A000002000000100A000008000000100A000001000000190A000009000000190A00000A000000180A000009000000180A000009000000170A000009000000170A000008000000160A000009000000160A000007000000150A000009000000150A000006000000280A000009000000280A00000B000000230A00000A000000230A000006000000220A00000A000000220A0000050000001F0A00000A0000001F0A0000040000001E0A00000A0000001E0A000003000000240A00000A000000240A0000070000001C0A00000A0000001C0A000001000000270A00000A000000270A00000A000000260A00000A000000260A000009000000250A00000A000000250A0000080000001D0A00000A0000001D0A0000020000001000000001000000010000000100000001000000030A0000BFD34D00C0D34D000FA900000EA900000000000002000000020000000100000002000000040A0000C3D34D00C4D34D0017A9000016A900000000000003000000030000000100000003000000050A0000C7D34D00C8D34D0009A9000008A9000000000000040000000400000001000000040000000C0A0000E4D44D00E5D44D0011A9000010A9000000000000050000000500000001000000050000000D0A0000E8D44D00E9D44D001BA900001AA9000000000000060000000600000001000000060000001B0A000083D64D0084D64D0013A9000012A900000000000010000000100000000200000001000000080A0000D4D44D00D5D44D0029A9000028A900000000000011000000110000000200000002000000090A0000D8D44D00D9D44D0017A9000016A9000000000000120000001200000002000000030000000A0A0000DCD44D00DDD44D0009A9000008A9000000000000130000001300000002000000040000000B0A0000E0D44D00E1D44D000FA900000EA9000000000000140000001400000002000000050000000E0A0000ECD44D00EDD44D000DA900000CA9000000000000150000001500000002000000060000000F0A0000F0D44D00F1D44D0013A9000012A9000000000000200000002000000003000000020000002A0A0000E3C10600E9C1060017A9000016A9000000000000230000002300000003000000050000002D0A0000E6C10600ECC106000FA900000EA9000000000000240000002400000003000000060000002E0A0000E7C10600EDC1060029A9000028A900000000000025000000250000000400000001000000200A00000000000000000000000000000000000000000000"));
            SendTunneledClientPacket(soeClient, StringToByteArray(/* AdventurersJournalQuestUpdatePacket */"D1000200000000000000"));
            SendPacketZoneDoneSendingInitialData(soeClient);
            PlayerCode.SendClientUpdatePacketDoneSendingPreloadCharacters(soeClient);
            SendPacketMOTD(soeClient);


            PlayerCharacter ourCharacter = PlayerCharacters.Find(x => x.client == soeClient);

            // spawn others' characters for our new player
            foreach (PlayerCharacter theirCharacter in PlayerCharacters)
                if (theirCharacter.client != soeClient) // character's client isn't us
                    theirCharacter.SpawnPcFor(soeClient); // spawn their character for us

            if (ourCharacter != null)
            {
                // spawn our character for other players
                List<SOEClient> Clients = _server.ConnectionManager.Clients;
                for (int i = 0; i < Clients.Count; i++)
                {
                    if (Clients[i] == null || Clients[i] == soeClient) continue; // client is connected and isn't us
                    ourCharacter.SpawnPcFor(Clients[i]); // spawn our character for other player
                }
            }
        }

        public static void SendPacketLoadWelcomeScreen(SOEClient soeClient)
        {
            SendTunneledClientPacket(soeClient, StringToByteArray(/* PacketLoadWelcomeScreen */"5D000103000000291800002A1800002B1800002C1800002D1800002E18000006000000080000004D4D4D444F4E55546F2006007E200600A1030000000000000C000000424552525943555043414B456D2006007C200600AB0300000000000008000000534B454C4554414C453E06004CAA0100830D0000040000006E6176790C000000535452415742455252494553463E060094A90100710D000008000000636F6E63726574650600000046524F474759473E0600450C0000EA040000000000000800000053414E4457494348483E06007E090000B503000000000000F42C020063000000"));
        }

        public static void SendPacketZoneDoneSendingInitialData(SOEClient soeClient)
        {
            var zoneDoneSendingInitialData = new SOEWriter((ushort)BasePackets.PacketZoneDoneSendingInitialData, true);

            SendTunneledClientPacket(soeClient, zoneDoneSendingInitialData.GetRaw());
        }

        public static void SendPacketMOTD(SOEClient soeClient)
        {
            var packet = new SOEWriter((ushort)BasePackets.PacketMOTD, true);

            packet.AddASCIIString("Welcome to OSFR!"); //MOTD title
            packet.AddASCIIString("Welcome, this is 100% a test build and anything seen here will be subject to change or break! If you happen to stumble across and aren't in our discord please join :) https://discord.gg/bd4junaw -OSFR"); //Message

            SendTunneledClientPacket(soeClient, packet.GetRaw());
        }

        private static void HandlePacketZoneTeleportRequest(SOEClient soeClient, SOEReader reader)
        {
            var zone = reader.ReadHostInt32();

            _log.Info($"HandlePacketZoneTeleportRequest Zone: {zone}");

            var pointOfInterestDefinition = PointOfInterestDefinitions.FirstOrDefault(x => x.Id == zone);

            if (pointOfInterestDefinition is null)
                return;

            if (pointOfInterestDefinition.Id == 2)
            {
                TeleportToBoatLot(soeClient);
            }
            else
            {
                var soeWriter = new SOEWriter((ushort)BasePackets.BaseClientUpdatePacket, true);

                soeWriter.AddHostUInt16((ushort)BaseClientUpdatePackets.ClientUpdatePacketUpdateLocation);

                soeWriter.AddFloat(pointOfInterestDefinition.X);
                soeWriter.AddFloat(pointOfInterestDefinition.Y);
                soeWriter.AddFloat(pointOfInterestDefinition.Z);
                soeWriter.AddFloat(pointOfInterestDefinition.Heading);

                soeWriter.AddFloat(0.0f);
                soeWriter.AddFloat(0.0f);
                soeWriter.AddFloat(0.0f);
                soeWriter.AddFloat(0.0f);

                soeWriter.AddBoolean(true);
                soeWriter.AddByte(1);

                SendTunneledClientPacket(soeClient, soeWriter.GetRaw());
            }

        }

        public static void HandlePacketZoneSafeTeleportRequest(SOEClient soeClient, SOEReader reader)
        {

            SOEWriter beginZoning = new SOEWriter((ushort)BasePackets.PacketClientBeginZoning, true);
            beginZoning.AddASCIIString("FabledRealms");
            beginZoning.AddHostUInt32(2u);
            beginZoning.AddFloat(-1414.636f);
            beginZoning.AddFloat(-27.631f);
            beginZoning.AddFloat(351.567f);
            beginZoning.AddFloat(0f);
            for (uint num = 0u; num < 4; num++)
            {
                beginZoning.AddHostUInt32(20 * num);
            }
            beginZoning.AddASCIIString("");
            beginZoning.AddBoolean(false);
            beginZoning.AddByte(2);
            beginZoning.AddHostUInt32(5u);
            beginZoning.AddHostUInt32(4u);
            beginZoning.AddHostUInt32(5u);
            beginZoning.AddBoolean(false);
            beginZoning.AddBoolean(false);

            SendTunneledClientPacket(soeClient, beginZoning.GetRaw());

        }
        private static void TeleportToBoatLot(SOEClient soeClient)
        {
            SOEWriter beginZoning = new SOEWriter((ushort)BasePackets.PacketClientBeginZoning, true);
            beginZoning.AddASCIIString("hsg_emptylot_boat_01");
            beginZoning.AddHostUInt32(2u);
            beginZoning.AddFloat(390f); // X
            beginZoning.AddFloat(33.5f); // Y
            beginZoning.AddFloat(425f); // Z
            beginZoning.AddFloat(0f);
            for (uint num = 0u; num < 4; num++)
            {
                beginZoning.AddHostUInt32(20 * num);
            }
            beginZoning.AddASCIIString("");
            beginZoning.AddBoolean(false);
            beginZoning.AddByte(2);
            beginZoning.AddHostUInt32(5u);
            beginZoning.AddHostUInt32(4u);
            beginZoning.AddHostUInt32(5u);
            beginZoning.AddBoolean(false);
            beginZoning.AddBoolean(false);

            SendTunneledClientPacket(soeClient, beginZoning.GetRaw());
        }
        private static void HandlePacketGameTimeSync(SOEClient soeClient, SOEReader reader)
        {
            var time = reader.ReadHostUInt64();
            var unknown2 = reader.ReadHostUInt32();
            var unknown3 = reader.ReadBoolean();

            //_log.Info($"HandlePacketGameTimeSync Time: {time}, Unknown2: {unknown2}, Unknown3: {unknown3} ");

            var soeWriter = new SOEWriter((ushort)BasePackets.PacketGameTimeSync, true);

            soeWriter.AddHostInt64(DateTimeOffset.Now.ToUnixTimeSeconds());
            soeWriter.AddHostInt32(8);
            soeWriter.AddBoolean(false);

            SendTunneledClientPacket(soeClient, soeWriter.GetRaw());
        }

        public static void SendTunneledClientPacket(SOEClient soeClient, byte[] rawBytes)
        {
            var tunneledClient = new SOEWriter((ushort)ClientGatewayBasePackets.PacketTunneledClientPacket, true);

            tunneledClient.AddBoolean(true);
            tunneledClient.AddHostUInt32((uint)rawBytes.Length);

            tunneledClient.AddBytes(rawBytes);

            soeClient.SendMessage(tunneledClient.GetFinalSOEMessage(soeClient));
        }

        [SOEMessageHandler("PacketTunneledClientWorldPacket", (ushort)ClientGatewayBasePackets.PacketTunneledClientWorldPacket, "CGAPI_527")]
        public static void HandleTunneledClientWorldPacket(SOEClient soeClient, SOEMessage soeMessage)
        {
            SOEReader reader = new SOEReader(soeMessage);

            var unknown = reader.ReadBoolean();
            var length = reader.ReadHostInt32();

            var opCode = reader.ReadHostUInt16();

            switch (opCode)
            {
                case (ushort)BasePackets.BaseCommandPacket:
                    HandleBaseCommandPacket(soeClient, reader);
                    break;

                case (ushort)BasePackets.WallOfDataBasePacket:
                    HandleWallOfDataBasePacket(soeClient, reader);
                    break;

                default:
                    var data = reader.ReadToEnd();
                    _log.Info($"HandleTunneledClientWorldPacket OpCode: {opCode}\n{BitConverter.ToString(data).Replace("-", "")}");
                    break;
            }
        }

        public static void HandleBaseCommandPacket(SOEClient soeClient, SOEReader reader)
        {
            var opCode = reader.ReadHostUInt16();

            switch (opCode)
            {
                default:
                    var data = reader.ReadToEnd();
                    _log.Info($"HandleBaseCommandPacket OpCode: {opCode}\n{BitConverter.ToString(data).Replace("-", "")}");
                    break;
            }
        }

        private static void HandlePlayerUpdatePacketUpdatePosition(SOEClient soeClient, SOEReader reader)
        {
            uint PlayerGUID = reader.ReadHostUInt64();
            float[] PlayerPosition = new float[3];
            for (var i = 0; i < PlayerPosition.Length; i++)
                PlayerPosition[i] = reader.ReadSingle();
            float[] PlayerRotation = new float[3];
            for (var i = 0; i < PlayerRotation.Length; i++)
                PlayerRotation[i] = reader.ReadSingle();

            byte CharacterState = reader.ReadByte();
            byte Unknown = reader.ReadByte();

            PlayerCharacter character = PlayerCharacters.Find(x => x.client == soeClient);
            if (character != null)
            {
                character.position = PlayerPosition;
                character.rotation = PlayerRotation;
                character.characterState = CharacterState;
                character.unknown = Unknown;
                PetManager.UpdatePosition(soeClient, character);
            }

            _log.InfoFormat($"GUID: {PlayerGUID} " +
                $"Position X: {PlayerPosition[0]} " +
                $"Position Z: {PlayerPosition[1]} " +
                $"Position Y: {PlayerPosition[2]} " +
                $"Rotation X: {PlayerRotation[0]} " +
                $"Rotation Y: {PlayerRotation[2]} ");
            
            var poiChange = new SOEWriter((byte)BasePackets.PacketPOIChangeMessage, true);

            if (Map.inBlackspore(PlayerPosition))
            {
                poiChange.AddHostInt32(3500); // NameId
                poiChange.AddHostInt32(2); //ZoneId
                poiChange.AddHostInt32(290); //AreaId
                SendTunneledClientPacket(soeClient, poiChange.GetRaw());
            }

            if (Map.inSanctuary(PlayerPosition))
            {
                poiChange.AddHostInt32(3499); // NameId
                poiChange.AddHostInt32(5); //ZoneId
                poiChange.AddHostInt32(290); //AreaId
                SendTunneledClientPacket(soeClient, poiChange.GetRaw());
            }

            if (Map.inSeaside(PlayerPosition))
            {
                poiChange.AddHostInt32(3501); // NameId
                poiChange.AddHostInt32(6); //ZoneId
                poiChange.AddHostInt32(290); //Unsure
                SendTunneledClientPacket(soeClient, poiChange.GetRaw());
            }

            if (Map.MerryValeMagnitude(PlayerPosition) < 290.0)
            {
                poiChange.AddHostInt32(3961); // NameId
                poiChange.AddHostInt32(4); //ZoneId
                poiChange.AddHostInt32(290); //Unsure
                SendTunneledClientPacket(soeClient, poiChange.GetRaw());
            }

            if (Map.BriarwoodMagnitude(PlayerPosition) < 230.0)
            {
                poiChange.AddHostInt32(3329); // NameId
                poiChange.AddHostInt32(3); //ZoneId
                poiChange.AddHostInt32(290); //Unsure
                SendTunneledClientPacket(soeClient, poiChange.GetRaw());
            }

            if (Map.inShroudedGlade(PlayerPosition) < 200.0)
            {
                poiChange.AddHostInt32(3502); // NameId
                poiChange.AddHostInt32(7); //ZoneId
                poiChange.AddHostInt32(290); //Unsure
                SendTunneledClientPacket(soeClient, poiChange.GetRaw());
            }

            if (Map.inSnowhill(PlayerPosition))
            {
                poiChange.AddHostInt32(3961); // NameId
                poiChange.AddHostInt32(8); //ZoneId
                poiChange.AddHostInt32(290); //Unsure
                SendTunneledClientPacket(soeClient, poiChange.GetRaw());
            }

            if (Map.inWugachug(PlayerPosition))
            {
                poiChange.AddHostInt32(3505); // NameId
                poiChange.AddHostInt32(9); //ZoneId
                poiChange.AddHostInt32(290); //Unsure
                SendTunneledClientPacket(soeClient, poiChange.GetRaw());
            }

            if (Map.SunstoneValleyMagnitude(PlayerPosition) < 600.0)
            {
                poiChange.AddHostInt32(74159); // NameId
                poiChange.AddHostInt32(10); //ZoneId
                poiChange.AddHostInt32(1178); //Unsure
                SendTunneledClientPacket(soeClient, poiChange.GetRaw());
            }
        }
        private static void HandleBaseChatPacket(SOEClient soeClient, SOEReader reader)
        {
            var subOpCode = reader.ReadHostUInt16();
            _log.Debug($"HandleBaseChatPacket:\n\t- Client ID: {soeClient.GetClientID()}\n\t - SubOpCode: {subOpCode}");
            switch (subOpCode)
            {
                case (ushort)BaseChatPackets.PacketChat:
                    HandlePacketChat(soeClient, reader);
                    break;
                case (ushort)BaseChatPackets.ChatPacketEnterArea:
                    break;
                case (ushort)BaseChatPackets.ChatPacketDebugChat:
                    break;
                case (ushort)BaseChatPackets.ChatPacketFromStringId:
                    break;
                case (ushort)BaseChatPackets.TellEchoPacket:
                    break;
            }
        }

        private static void HandlePacketChat(SOEClient soeClient, SOEReader reader)
        {
            ushort messageType = reader.ReadHostUInt16();
            ulong guid1 = reader.ReadHostUInt64();
            ulong guid2 = reader.ReadHostUInt64();

            for (int i = 0; i < 3; i++)
                reader.ReadHostInt32(); // unknown in player information struct
            string senderFirstName = reader.ReadASCIIString();
            string senderLastName = reader.ReadASCIIString();

            for (int i = 0; i < 3; i++)
                reader.ReadHostInt32(); // unknown in player information struct
            string targetFirstName = reader.ReadASCIIString();
            string targetLastName = reader.ReadASCIIString();

            string message = reader.ReadASCIIString();

            _ = reader.ReadSingle();
            _ = reader.ReadSingle();
            _ = reader.ReadSingle();
            _ = reader.ReadSingle();

            _ = reader.ReadHostUInt64();
            _ = reader.ReadHostInt32();

            int? Unknown4;
            if (messageType == 8)
                Unknown4 = reader.ReadHostInt32();


            PlayerCharacter character = PlayerCharacters.Find(x => x.client == soeClient);
            if (character == null) return;
            _log.Debug($"Client #{soeClient.GetClientID()} sent a PacketChat: " +
                $"- Their Character's GUID: {character.playerGUID} " +
                $"- GUID #1: {guid1} " +
                $"- GUID #2: {guid2} " +
                $"- Message Type: {messageType} " +
                $"- Recipient: {targetFirstName} {targetLastName} " +
                $"- Message: \"{message}\"");
            character.SendPacketChat(soeClient, messageType, guid1, guid2, message, targetFirstName, targetLastName);
        }

        private static void HandleBaseQuickChatPacket(SOEClient soeClient, SOEReader reader)
        {
            var subOpCode = reader.ReadHostUInt16();

            switch (subOpCode)
            {
                case (ushort)BaseQuickChatPackets.QuickChatSendChatToChannelPacket:
                    HandleQuickChatSendChatToChannelPacket(soeClient, reader);
                    break;
            }
        }

        private static void HandleQuickChatSendChatToChannelPacket(SOEClient soeClient, SOEReader reader)
        {
            var commandId = reader.ReadHostInt32();
            _ = reader.ReadHostInt64();

            // UnknownStruct3
            _ = reader.ReadHostInt32();
            _ = reader.ReadHostInt32();
            _ = reader.ReadHostInt32();
            _ = reader.ReadASCIIString();
            _ = reader.ReadASCIIString();

            var channelId = reader.ReadHostInt16();
            _ = reader.ReadHostInt32();
            var guildGuid = reader.ReadHostInt64();

            PlayerCharacter character = PlayerCharacters.Find(x => x.client == soeClient);

            character.SendQuickChatSendChatToChannelPacket(soeClient, commandId, channelId, guildGuid);
        }

        public static void SendTunneledClientWorldPacket(SOEClient soeClient, byte[] rawBytes)
        {
            var tunneledClient = new SOEWriter((ushort)ClientGatewayBasePackets.PacketTunneledClientWorldPacket, true);

            tunneledClient.AddBoolean(true);
            tunneledClient.AddHostUInt32((uint)rawBytes.Length);

            tunneledClient.AddBytes(rawBytes);

            soeClient.SendMessage(tunneledClient.GetFinalSOEMessage(soeClient));
        }

        public static void HandleWallOfDataBasePacket(SOEClient soeClient, SOEReader reader)
        {
            var OpCode = reader.ReadByte();

            switch (OpCode)
            {
                case (byte)WallOfDataBasePackets.WallOfDataUIEventPacket:
                    //SendWallOfDataUIEventPacket(reader);
                    break;

                case (byte)WallOfDataBasePackets.WallOfDataPlayerKeyboardPacket:
                    //SendWallOfDataPlayerKeyboardPacket(soeClient, reader);
                    break;

                default:
                    var data = reader.ReadToEnd();
                    _log.Info($"HandleWallOfDataBasePacket SubOpCode: {OpCode}\n{BitConverter.ToString(data).Replace("-", "")}");
                    break;
            }
        }

        public static void SendWallOfDataUIEventPacket(SOEReader reader)
        {
            string Browser = reader.ReadASCIIString();
            string Selected = reader.ReadASCIIString();
            string SelectedSlot = reader.ReadASCIIString();

            //log.Info($"HandleWallOfDataUIEventPacket: {Browser} : {Selected} : {SelectedSlot}");
        }

        public static void SendWallOfDataPlayerKeyboardPacket(SOEClient soeClient, SOEReader reader)
        {
            int Count = reader.ReadHostInt32();

            for (var i = 0; i < Count; i++)
            {
                _log.Info($"{(char)reader.ReadHostInt64()}");
            }

        }

        public static byte[] StringToByteArray(string hex)
        {
            byte[] array = new byte[hex.Length / 2];
            for (int i = 0; i < hex.Length; i += 2)
            {
                array[i / 2] = Convert.ToByte(hex.Substring(i, 2), 16);
            }
            return array;
        }


        public static Random _random = new Random();
        public static readonly List<ulong> ConsumedGUIDs = new List<ulong>();
        public static ulong RandomGUID()
        {
            ulong GUID;
            while (true)
            {
                byte[] randomBytes = new byte[8];
                for (int i = 0; i < randomBytes.Length; i++)
                    randomBytes[i] = (byte)_random.Next(0, 255);
                GUID = BitConverter.ToUInt64(randomBytes, 0);
                if (!ConsumedGUIDs.Contains(GUID))
                    break;
            }
            return GUID;
        }

        private static void HandleBaseInventoryPacket(SOEClient soeClient, SOEReader reader)
        {

            var OpCode = reader.ReadHostUInt16();
            var GUID = reader.ReadHostInt32();
            var Class = reader.ReadHostInt32();
            var Slot = reader.ReadHostInt32();

            switch (OpCode)
            {
                case (ushort)BaseInventoryPackets.InventoryPacketEquipByGuid:
                    SendEquipItemByGuid(soeClient, GUID, Class, Slot);
                    break;

                case (ushort)BaseInventoryPackets.InventoryPacketItemActionBarAssign:
                    _log.Debug("InventoryPacketItemActionBarAssign");
                    break;

                case (ushort)BaseInventoryPackets.InventoryPacketItemRequirementRequest:
                    _log.Debug("InventoryPacketItemRequirementRequest");
                    break;

                default:
                    var data = reader.ReadToEnd();
                    _log.Info($"HandleBaseInventoryPacket SubOpCode: {OpCode}\n{BitConverter.ToString(data).Replace("-", "")}");
                    break;
            }
        }

        private static void SendEquipItemByGuid(SOEClient soeClient, int GUID, int Class, int Slot)
        {
            var player = PlayerCharacters.Find(x => x.client == soeClient);
            var clientItem = player.CharacterData.ClientItems.Find(cItem => cItem.Guid == GUID);
            var clientItemDef = ClientItemDefinitions.Find(cItemDef => cItemDef.Id == clientItem.Definition);
            var tint = clientItem.Tint;
        
            var packet = new SOEWriter((ushort)BasePackets.BasePlayerUpdatePacket, true);
            packet.AddHostUInt16((ushort)BasePlayerUpdatePackets.PlayerUpdatePacketEquipItemChange);
            packet.AddHostInt64(player.playerGUID);
            packet.AddHostInt32(clientItemDef.IconData.Id);
            packet.AddASCIIString(clientItemDef.ModelName);
            packet.AddASCIIString(clientItemDef.TextureAlias);
            packet.AddASCIIString(clientItemDef.TintAlias);
        
            if (tint == 0)
            {
                packet.AddHostInt32(clientItemDef.IconData.TintId);
            }
            else
            {
                packet.AddHostInt32(tint);
            }
            packet.AddHostInt32(clientItemDef.CompositeEffectId);
            packet.AddHostInt32(Slot);
            packet.AddHostInt32(Class);
            packet.AddHostInt32(clientItemDef.Class);
            packet.AddBoolean(true);

            BroadcastManager.BroadcastToPlayers(packet.GetRaw());
            SendClientUpdatePacketEquipItem(soeClient, GUID, Class, Slot);
        }

        private static void SendClientUpdatePacketEquipItem(SOEClient soeClient, int GUID, int Class, int Slot)
        {
            var player = PlayerCharacters.Find(x => x.client == soeClient);
            var clientItem = player.CharacterData.ClientItems.Find(cItem => cItem.Guid == GUID);
            var clientItemDef = ClientItemDefinitions.Find(cItemDef => cItemDef.Id == clientItem.Definition);

            var packet = new SOEWriter((ushort)BasePackets.BaseClientUpdatePacket, true);
            packet.AddHostUInt16((ushort)BaseClientUpdatePackets.ClientUpdatePacketEquipItem);
            packet.AddHostInt32(GUID);
            packet.AddASCIIString(clientItemDef.ModelName);
            packet.AddASCIIString(clientItemDef.TextureAlias);
            packet.AddASCIIString(clientItemDef.TintAlias);

            if (clientItem.Tint == 0)
            {
                packet.AddHostInt32(clientItemDef.IconData.TintId);
            }
            else
            {
                packet.AddHostInt32(clientItem.Tint);
            }

            packet.AddHostInt32(clientItemDef.CompositeEffectId);
            packet.AddHostInt32(Slot);
            packet.AddHostInt32(Class);
            packet.AddHostInt32(clientItemDef.Class);
            packet.AddBoolean(true);

            SendTunneledClientPacket(soeClient, packet.GetRaw());
        }
    }
}



